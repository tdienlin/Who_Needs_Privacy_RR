---
title: "Results"
output:
  html_document:
    toc: TRUE
    toc_float:
      collapsed: FALSE
    toc_depth: 2
    code_folding: hide
    df_print: paged
bibliography      : 
  - "bibliography/r-references.bib"
  - "bibliography/references.bib"
---

```{r knitr-setup, include=F}
set.seed(170819)

knitr::opts_chunk$set(
  warning=F
  , echo=T
  , error=F
  , message=F
  , cache=T
  , tidy=T
  # , dev = 'pdf'
  # , cache.extra = knitr::rand_seed
  , fig.height = 4
  , fig.width = 6
  )

options(
  digits = 3, 
  width = 150,
  max.print = 100000000
  )
```

Here you can find the results of our study. 

# Set-Up

We first load the required packages.

```{r packages, include=T, echo=T, results='hide', cache=F}
# install packages
# devtools::install_github("https://github.com/tdienlin/td")

library(confintr)
library(corrplot)
library(easystats)
library(ggplot2)
library(kableExtra)
library(knitr)
library(lavaan)
library(magrittr)
library(MVN)
library(naniar)
library(PerFit)
library(psych)
library(sjlabelled)
library(semTools)
library(tidyverse)
library(td)
```

We then load the cleaned data.

```{r data, include=T, echo=T, results='hide', cache=T}
load("data/workspace_2.RData")
source("custom_functions.R")
```

# Items Characteristics

In what follows, we report item characteristics.

## Sociodemographics

To improve privacy, we didn't collect exact but binned measures of sociodemographics.

### Age

```{r}
d$age %>% 
  sjlabelled::as_label() %>% 
  data_tabulate()
```

No person indicated being younger than 18 years old. Hence, everybody could be included.

```{r}
age_m <- 
  mean(d$age)
```

The mean age was 45 to 54 years of age.

### Gender

```{r}
d$GEN %>% 
  sjlabelled::as_label() %>% 
  data_tabulate()
```

48 percent were male, 50 female, and 1 percent indicated third/other gender.

### Education

```{r}
d$COL %>% 
  sjlabelled::as_label() %>% 
  data_tabulate()
```

69% reported having a college degree. 

### Ethnicity

```{r}
d$ETH %>% 
  sjlabelled::as_label() %>% 
  data_tabulate()
```

78 % percent were white, 22 % not white.

### Political orientation

```{r}
d$CON %>% 
  sjlabelled::as_label() %>% 
  data_tabulate()
```

We see a certain bias toward participants being liberal as opposed to conservative.

## Personality

All following items were answered on a 7-point scale with the following options:

"To what extent do you agree or disagree with the following statements?"

(-3) Strongly Disagree, (-2) Disagree, (-1) Slightly Disagree, (0) Neutral, (1) Slightly Agree (2) Agree, (3) Strongly Agree

### Ceiling/Floor effects

Let's first check for ceiling and floor effects.

```{r}
d_extremes <-
  d %>%
  select(
    paste0(rep(vars_pers_pri, each = 4), "_0", 1:4)
  ) %>% 
  apply(
    2,  mean, na.rm = T
  ) %>% 
  as.data.frame() %>% 
  select(Mean = ".") %>% 
  arrange(Mean)
```

Lowest values: 

```{r}
head(d_extremes)
```

No item below floor (1.5) threshold.

Highest values: 

```{r}
tail(d_extremes)
```

No item above ceiling (6.5) thresholds.

### Honesty Humility
#### Sincerity

 1. If I want something from a person I dislike, I will act very nicely toward that person in order to get it.
 1. I wouldn't use flattery to get a raise or promotion at work, even if I thought it would succeed.
 1. If I want something from someone, I will laugh at that person's worst jokes.
 1. I wouldn't pretend to like someone just to get that person to do favors for me.

```{r}
name <- "HEX_HOH_SIN"

plot_hist(name)
```

```{r}
mardia(
  select(
    d, paste0(rep(paste0(name, "_0"), 4), 1:4)
  )
)
```

Assumption of multivariate normality violated. Hence we'll use the robust estimator.

```{r}
model <- "HEX_HOH_SIN =~ HEX_HOH_SIN_01 + HEX_HOH_SIN_02 + HEX_HOH_SIN_03 + HEX_HOH_SIN_04"

assign(
  paste("fit", name, sep = "_"), 
  cfa(model, d, estimator = "MLM")
  )

summary(get(paste0("fit_", name)), fit = TRUE, standardized = TRUE)
```

Fit is okay, but RMSEA is significantly above .10. Let's hence inspect modification indices to see if there are potential fixes.

```{r}
modindices(fit_HEX_HOH_SIN)
```

Suggests that item 1 & 3, and item 2 & 4 build subdimensions. Let's allow covariances.

```{r}
model <- 
  "HEX_HOH_SIN =~ HEX_HOH_SIN_01 + HEX_HOH_SIN_02 + HEX_HOH_SIN_03 + HEX_HOH_SIN_04
  HEX_HOH_SIN_01 ~~ a*HEX_HOH_SIN_03
  HEX_HOH_SIN_02 ~~ a*HEX_HOH_SIN_04
"

assign(
  paste("fit", name, sep = "_"), 
  cfa(model, d, estimator = "MLM")
  )

summary(get(paste0("fit_", name)), fit = TRUE, standardized = TRUE)
```

Fit is now great.

#### Fairness

 1. If I knew that I could never get caught, I would be willing to steal a million dollars.
 1. I would be tempted to buy stolen property if I were financially tight.
 1. I would never accept a bribe, even if it were very large.
 1. I’d be tempted to use counterfeit money, if I were sure I could get away with it.

```{r}
name <- "HEX_HOH_FAI"

plot_hist(name)
```

```{r}
mardia(
  select(
    d, paste0(rep(paste0(name, "_0"), 4), 1:4)
  )
)
```

Assumption of multivariate normality violated. Hence we'll use the robust estimator.

```{r}

model <- "HEX_HOH_FAI =~ HEX_HOH_FAI_01 + HEX_HOH_FAI_02 + HEX_HOH_FAI_03 + HEX_HOH_FAI_04"

assign(
  paste("fit", name, sep = "_"), 
  cfa(model, d, estimator = "MLM")
  )

summary(get(paste0("fit_", name)), fit = TRUE, standardized = TRUE)
```

Fit is good.

#### Greed Avoidance

 1. Having a lot of money is not especially important to me.
 1. I would like to live in a very expensive, high-class neighborhood.
 1. I would like to be seen driving around in a very expensive car.
 1. I would get a lot of pleasure from owning expensive luxury goods.

```{r}
name <- "HEX_HOH_GRE"

plot_hist(name)
```


```{r}
mardia(
  select(
    d, paste0(rep(paste0(name, "_0"), 4), 1:4)
  )
)
```

Assumption of multivariate normality violated. Hence we'll use the robust estimator.

```{r}

model <- "HEX_HOH_GRE =~ HEX_HOH_GRE_01 + HEX_HOH_GRE_02 + HEX_HOH_GRE_03 + HEX_HOH_GRE_04"

assign(
  paste("fit", name, sep = "_"), 
  cfa(model, d, estimator = "MLM")
  )

summary(get(paste0("fit_", name)), fit = TRUE, standardized = TRUE)
```

Fit is okaish, but RMSEA above .10. Let's inspect modification indices.

```{r}
modindices(fit_HEX_HOH_GRE)
```

Item 1 & 2, and item 3 & 4 form subdimensions.

```{r}
model <- "
  HEX_HOH_GRE =~ HEX_HOH_GRE_01 + HEX_HOH_GRE_02 + HEX_HOH_GRE_03 + HEX_HOH_GRE_04
  HEX_HOH_GRE_01 ~~ a*HEX_HOH_GRE_02
  HEX_HOH_GRE_03 ~~ a*HEX_HOH_GRE_04
"

assign(
  paste("fit", name, sep = "_"), 
  cfa(model, d, estimator = "MLM")
  )

summary(get(paste0("fit_", name)), fit = TRUE, standardized = TRUE)
```

Fit is now great.

#### Modesty

 1. I am an ordinary person who is no better than others.
 1. I wouldn’t want people to treat me as though I were superior to them.
 1. I think that I am entitled to more respect than the average person is.
 1. I want people to know that I am an important person of high status.

```{r}
name <- "HEX_HOH_MOD"

plot_hist(name)
```


```{r}
mardia(
  select(
    d, paste0(rep(paste0(name, "_0"), 4), 1:4)
  )
)
```

Assumption of multivariate normality violated. Hence we'll use the robust estimator.

```{r}
model <- "HEX_HOH_MOD =~ HEX_HOH_MOD_01 + HEX_HOH_MOD_02 + HEX_HOH_MOD_03 + HEX_HOH_MOD_04"

assign(
  paste("fit", name, sep = "_"), 
  cfa(model, d, estimator = "MLM")
  )

summary(get(paste0("fit_", name)), fit = TRUE, standardized = TRUE)
```

Fit is good.

#### Honesty Humility

Let's also look at the dimension itself.

```{r}
model_hex_hoh <- "
# Personality Factors
HEX_HOH =~ HEX_HOH_SIN + HEX_HOH_FAI + HEX_HOH_GRE + HEX_HOH_MOD
HEX_HOH_SIN =~ HEX_HOH_SIN_01 + HEX_HOH_SIN_02 + HEX_HOH_SIN_03 + HEX_HOH_SIN_04
HEX_HOH_FAI =~ HEX_HOH_FAI_01 + HEX_HOH_FAI_02 + HEX_HOH_FAI_03 + HEX_HOH_FAI_04
HEX_HOH_GRE =~ HEX_HOH_GRE_01 + HEX_HOH_GRE_02 + HEX_HOH_GRE_03 + HEX_HOH_GRE_04
HEX_HOH_MOD =~ HEX_HOH_MOD_01 + HEX_HOH_MOD_02 + HEX_HOH_MOD_03 + HEX_HOH_MOD_04

# Covariances
HEX_HOH_SIN_01 ~~ HEX_HOH_SIN_03
HEX_HOH_SIN_02 ~~ HEX_HOH_SIN_04
HEX_HOH_GRE_01 ~~ HEX_HOH_GRE_02
HEX_HOH_GRE_03 ~~ HEX_HOH_GRE_04
"
fit_hex_hoh <- sem(model_hex_hoh, d, estimator = "MLM", fixed.x = TRUE)
summary(fit_hex_hoh, standardized = TRUE, fit = TRUE)
```

### Emotionality
#### Fearfulness

 1. I would feel afraid if I had to travel in bad weather conditions.
 1. I don’t mind doing jobs that involve dangerous work.
 1. When it comes to physical danger, I am very fearful.
 1. Even in an emergency I wouldn't feel like panicking.

```{r}
name <- "HEX_EMO_FEA"

plot_hist(name)
```


```{r}
mardia(
  select(
    d, paste0(rep(paste0(name, "_0"), 4), 1:4)
  )
)
```

Assumption of multivariate normality violated. Hence we'll use the robust estimator.

```{r}
model <- "HEX_EMO_FEA =~ HEX_EMO_FEA_01 + HEX_EMO_FEA_02 + HEX_EMO_FEA_03 + HEX_EMO_FEA_04"

assign(
  paste("fit", name, sep = "_"), 
  cfa(model, d, estimator = "MLR", missing = "FIML")
  )

summary(get(paste0("fit_", name)), fit = TRUE, standardized = TRUE)
```

Fit is great.

#### Anxiety
 
 1. I sometimes can't help worrying about little things.
 1. I worry a lot less than most people do.
 1. I rarely, if ever, have trouble sleeping due to stress or anxiety.
 1. I get very anxious when waiting to hear about an important decision.
 
```{r}
name <- "HEX_EMO_ANX"

plot_hist(name)
```


```{r}
mardia(
  select(
    d, paste0(rep(paste0(name, "_0"), 4), 1:4)
  )
)
```

Assumption of multivariate normality violated. Hence we'll use the robust estimator.

```{r}

model <- "HEX_EMO_ANX =~ HEX_EMO_ANX_01 + HEX_EMO_ANX_02 + HEX_EMO_ANX_03 + HEX_EMO_ANX_04"

assign(
  paste("fit", name, sep = "_"), 
  cfa(model, d, estimator = "MLM")
  )

summary(get(paste0("fit_", name)), fit = TRUE, standardized = TRUE)
```

Fit is great.

#### Dependence

 1. When I suffer from a painful experience, I need someone to make me feel comfortable.
 1. I can handle difficult situations without needing emotional support from anyone else.
 1. Whenever I feel worried about something, I want to share my concern with another person.
 1. I rarely discuss my problems with other people.

```{r}
name <- "HEX_EMO_DEP"

plot_hist(name)
```


```{r}
mardia(
  select(
    d, paste0(rep(paste0(name, "_0"), 4), 1:4)
  )
)
```

Assumption of multivariate normality violated. Hence we'll use the robust estimator.

```{r}
model <- "
  HEX_EMO_DEP =~ HEX_EMO_DEP_01 + HEX_EMO_DEP_02 + HEX_EMO_DEP_03 + HEX_EMO_DEP_04
"

assign(
  paste("fit", name, sep = "_"), 
  cfa(model, d, estimator = "MLM")
  )

summary(get(paste0("fit_", name)), fit = TRUE, standardized = TRUE)
```

Fit is bad; TLI and RMSEA outside thresholds.

```{r}
modindices(fit_HEX_EMO_DEP)
```

Not entirely clear. Let's allow items 1 & 4 to correlate, and items 2 & 3.

```{r}
model <- "
HEX_EMO_DEP =~ HEX_EMO_DEP_01 + HEX_EMO_DEP_02 + HEX_EMO_DEP_03 + HEX_EMO_DEP_04
HEX_EMO_DEP_01 ~~ a*HEX_EMO_DEP_04
HEX_EMO_DEP_02 ~~ a*HEX_EMO_DEP_03
"
assign(
  paste("fit", name, sep = "_"), 
  cfa(model, d, estimator = "MLM")
  )

summary(get(paste0("fit_", name)), fit = TRUE, standardized = TRUE)
```

Fit not great, but okay.

#### Sentimentality

 1. I feel like crying when I see other people crying.
 1. When someone I know well is unhappy, I can almost feel that person's pain myself.
 1. I feel strong emotions when someone close to me is going away for a long time.
 1. I remain unemotional even in situations where most people get very sentimental.

```{r}
name <- "HEX_EMO_SEN"

plot_hist(name)
```


```{r}
mardia(
  select(
    d, paste0(rep(paste0(name, "_0"), 4), 1:4)
  )
)
```

Assumption of multivariate normality violated. Hence we'll use the robust estimator.

```{r}

model <- "
HEX_EMO_SEN =~ HEX_EMO_SEN_01 + HEX_EMO_SEN_02 + HEX_EMO_SEN_03 + HEX_EMO_SEN_04
"

assign(
  paste("fit", name, sep = "_"), 
  cfa(model, d, estimator = "MLM")
  )

summary(get(paste0("fit_", name)), fit = TRUE, standardized = TRUE)
```

Fit not terrible, but TLI and RSMEA outside of thresholds.

```{r}
modindices(fit_HEX_EMO_SEN)
```

Items 1 & 3, and items 2 & 4 want to covary.

```{r}
model <- "
  HEX_EMO_SEN =~ HEX_EMO_SEN_01 + HEX_EMO_SEN_02 + HEX_EMO_SEN_03 + HEX_EMO_SEN_04
  HEX_EMO_SEN_01 ~~ a*HEX_EMO_SEN_03
  HEX_EMO_SEN_02 ~~ a*HEX_EMO_SEN_04
"

assign(
  paste("fit", name, sep = "_"), 
  cfa(model, d, estimator = "MLM")
  )

summary(get(paste0("fit_", name)), fit = TRUE, standardized = TRUE)
```

Fit is now good.

#### Emotionality

Let's look at overall dimension.

```{r}
model_hex_emo <- "
HEX_EMO =~ HEX_EMO_FEA + HEX_EMO_ANX + HEX_EMO_DEP + HEX_EMO_SEN
HEX_EMO_FEA =~ HEX_EMO_FEA_01 + HEX_EMO_FEA_02 + HEX_EMO_FEA_03 + HEX_EMO_FEA_04
HEX_EMO_ANX =~ HEX_EMO_ANX_01 + HEX_EMO_ANX_02 + HEX_EMO_ANX_03 + HEX_EMO_ANX_04
HEX_EMO_DEP =~ HEX_EMO_DEP_01 + HEX_EMO_DEP_02 + HEX_EMO_DEP_03 + HEX_EMO_DEP_04
HEX_EMO_SEN =~ HEX_EMO_SEN_01 + HEX_EMO_SEN_02 + HEX_EMO_SEN_03 + HEX_EMO_SEN_04
HEX_EMO_DEP_01 ~~ HEX_EMO_DEP_04
HEX_EMO_DEP_02 ~~ HEX_EMO_DEP_03
HEX_EMO_SEN_01 ~~ HEX_EMO_SEN_03
HEX_EMO_SEN_02 ~~ HEX_EMO_SEN_04
"
fit_hex_emo <- sem(model_hex_emo, d, estimator = "MLM", fixed.x = TRUE)
summary(fit_hex_emo, standardized = TRUE, fit = TRUE)
```

Fit is subpar. Let's inspect.

```{r}
modindices(fit_hex_emo, minimum.value = 40)
```

Suggests one major cross-loading: 

 1. HEX_EMO with	HEX_EMO_FEA_04

```{r}
model_hex_emo <- "
HEX_EMO =~ HEX_EMO_FEA + HEX_EMO_ANX + HEX_EMO_DEP + HEX_EMO_SEN
HEX_EMO_FEA =~ HEX_EMO_FEA_01 + HEX_EMO_FEA_02 + HEX_EMO_FEA_03 + HEX_EMO_FEA_04
HEX_EMO_ANX =~ HEX_EMO_ANX_01 + HEX_EMO_ANX_02 + HEX_EMO_ANX_03 + HEX_EMO_ANX_04 + HEX_EMO_FEA_04
HEX_EMO_DEP =~ HEX_EMO_DEP_01 + HEX_EMO_DEP_02 + HEX_EMO_DEP_03 + HEX_EMO_DEP_04
HEX_EMO_SEN =~ HEX_EMO_SEN_01 + HEX_EMO_SEN_02 + HEX_EMO_SEN_03 + HEX_EMO_SEN_04

HEX_EMO_DEP_01 ~~ HEX_EMO_DEP_04
HEX_EMO_DEP_02 ~~ HEX_EMO_DEP_03
HEX_EMO_SEN_01 ~~ HEX_EMO_SEN_03
HEX_EMO_SEN_02 ~~ HEX_EMO_SEN_04
"
fit_hex_emo <- sem(model_hex_emo, d, estimator = "MLM", fixed.x = TRUE)
summary(fit_hex_emo, standardized = TRUE, fit = TRUE)
```

Still not great. Let's reinspect.

```{r}
modindices(fit_hex_emo, minimum.value = 50)
```

No clear candidate emerges. Will keep it that way.

### Extraversion
#### Social Self-Esteem

 1. I feel reasonably satisfied with myself overall.
 1. I think that most people like some aspects of my personality.
 1. I feel that I am an unpopular person.
 1. I sometimes feel that I am a worthless person.
 
```{r}
name <- "HEX_EXT_SSE"

plot_hist(name)
```


```{r}
mardia(
  select(
    d, paste0(rep(paste0(name, "_0"), 4), 1:4)
  )
)
```

Assumption of multivariate normality violated. Hence we'll use the robust estimator.

```{r}

model <- "
  HEX_EXT_SSE =~ HEX_EXT_SSE_01 + HEX_EXT_SSE_02 + HEX_EXT_SSE_03 + HEX_EXT_SSE_04
"

assign(
  paste("fit", name, sep = "_"), 
  cfa(model, d, estimator = "MLR", missing = "FIML")
  )

summary(get(paste0("fit_", name)), fit = TRUE, standardized = TRUE)
```

Fit is not good. Let's inspect.

```{r}
modindices(fit_HEX_EXT_SSE)
```

Items 1 & 4 and 2 & 3 want to covary.

```{r}
model <- "
  HEX_EXT_SSE =~ HEX_EXT_SSE_01 + HEX_EXT_SSE_02 + HEX_EXT_SSE_03 + HEX_EXT_SSE_04
  HEX_EXT_SSE_01 ~~ a*HEX_EXT_SSE_04
  HEX_EXT_SSE_02 ~~ a*HEX_EXT_SSE_03
"

assign(
  paste("fit", name, sep = "_"), 
  cfa(model, d, estimator = "MLR", missing = "FIML")
  )

summary(get(paste0("fit_", name)), fit = TRUE, standardized = TRUE)
```

Fit is now okay.

#### Social Boldness

 1. I rarely express my opinions in group meetings.
 1. In social situations, I'm usually the one who makes the first move.
 1. When I'm in a group of people, I'm often the one who speaks on behalf of the group.
 1. I tend to feel quite self-conscious when speaking in front of a group of people.

```{r}
name <- "HEX_EXT_BOL"

plot_hist(name)
```


```{r}
mardia(
  select(
    d, paste0(rep(paste0(name, "_0"), 4), 1:4)
  )
)
```

Assumption of multivariate normality violated. Hence we'll use the robust estimator.

```{r}

model <- "
  HEX_EXT_BOL =~ HEX_EXT_BOL_01 + HEX_EXT_BOL_02 + HEX_EXT_BOL_03 + HEX_EXT_BOL_04
"

assign(
  paste("fit", name, sep = "_"), 
  cfa(model, d, estimator = "MLM")
  )

summary(get(paste0("fit_", name)), fit = TRUE, standardized = TRUE)
```

RMSEA significantly larger than .10, will hence check modification indices.

```{r}
modindices(fit_HEX_EXT_BOL)
```

Let's allow 1 & 4, and 2 & 3 to covary.

```{r}
model <- "
  HEX_EXT_BOL =~ HEX_EXT_BOL_01 + HEX_EXT_BOL_02 + HEX_EXT_BOL_03 + HEX_EXT_BOL_04
  HEX_EXT_BOL_01 ~~ a*HEX_EXT_BOL_04
  HEX_EXT_BOL_02 ~~ a*HEX_EXT_BOL_03
"

assign(
  paste("fit", name, sep = "_"), 
  cfa(model, d, estimator = "MLM")
  )

summary(get(paste0("fit_", name)), fit = TRUE, standardized = TRUE)
```

Fit is good.

#### Sociability

 1. I avoid making "small talk" with people.
 1. I enjoy having lots of people around to talk with.
 1. I prefer jobs that involve active social interaction to those that involve working alone.
 1. The first thing that I always do in a new place is to make friends.

```{r}
name <- "HEX_EXT_SOC"

plot_hist(name)
```


```{r}
mardia(
  select(
    d, paste0(rep(paste0(name, "_0"), 4), 1:4)
  )
)
```

Assumption of multivariate normality violated. Hence we'll use the robust estimator.

```{r}
model <- "
HEX_EXT_SOC =~ HEX_EXT_SOC_01 + HEX_EXT_SOC_02 + HEX_EXT_SOC_03 + HEX_EXT_SOC_04
"

assign(
  paste("fit", name, sep = "_"), 
  cfa(model, d, estimator = "MLM")
  )

summary(get(paste0("fit_", name)), fit = TRUE, standardized = TRUE)
```

Fit is good.

#### Liveliness

 1. I am energetic nearly all the time.
 1. On most days, I feel cheerful and optimistic.
 1. People often tell me that I should try to cheer up.
 1. Most people are more upbeat and dynamic than I generally am.

```{r}
name <- "HEX_EXT_LIV"

plot_hist(name)
```


```{r}
mardia(
  select(
    d, paste0(rep(paste0(name, "_0"), 4), 1:4)
  )
)
```

Assumption of multivariate normality violated. Hence we'll use the robust estimator.

```{r}
model <- "
  HEX_EXT_LIV =~ HEX_EXT_LIV_01 + HEX_EXT_LIV_02 + HEX_EXT_LIV_03 + HEX_EXT_LIV_04
"

assign(
  paste("fit", name, sep = "_"), 
  cfa(model, d, estimator = "MLM")
  )

summary(get(paste0("fit_", name)), fit = TRUE, standardized = TRUE)
```

Fit is supar, let's inspect.

```{r}
modindices(fit_HEX_EXT_LIV)
```

```{r}
model <- "
  HEX_EXT_LIV =~ HEX_EXT_LIV_01 + HEX_EXT_LIV_02 + HEX_EXT_LIV_03 + HEX_EXT_LIV_04
  HEX_EXT_LIV_01 ~~ a*HEX_EXT_LIV_03
  HEX_EXT_LIV_02 ~~ a*HEX_EXT_LIV_04
"

assign(
  paste("fit", name, sep = "_"), 
  cfa(model, d, estimator = "MLM")
  )

summary(get(paste0("fit_", name)), fit = TRUE, standardized = TRUE)
```

Again, fit is not really good --> but it seems preferable to stick to this more parsimoneous solution. 

#### Extraversion

Let's analyze main model.

```{r}
model_hex_ext <- "
HEX_EXT =~ HEX_EXT_SSE + HEX_EXT_BOL + HEX_EXT_SOC + HEX_EXT_LIV
HEX_EXT_SSE =~ HEX_EXT_SSE_01 + HEX_EXT_SSE_02 + HEX_EXT_SSE_03 + HEX_EXT_SSE_04
HEX_EXT_BOL =~ HEX_EXT_BOL_01 + HEX_EXT_BOL_02 + HEX_EXT_BOL_03 + HEX_EXT_BOL_04
HEX_EXT_SOC =~ HEX_EXT_SOC_01 + HEX_EXT_SOC_02 + HEX_EXT_SOC_03 + HEX_EXT_SOC_04
HEX_EXT_LIV =~ HEX_EXT_LIV_01 + HEX_EXT_LIV_02 + HEX_EXT_LIV_03 + HEX_EXT_LIV_04

HEX_EXT_SSE_01 ~~ HEX_EXT_SSE_04
HEX_EXT_SSE_02 ~~ HEX_EXT_SSE_03
HEX_EXT_BOL_01 ~~ HEX_EXT_BOL_04
HEX_EXT_BOL_02 ~~ HEX_EXT_BOL_03
HEX_EXT_LIV_01 ~~ HEX_EXT_LIV_03
HEX_EXT_LIV_02 ~~ HEX_EXT_LIV_04
"
fit_hex_ext <- sem(model_hex_ext, d, estimator = "MLM", fixed.x = TRUE)
summary(fit_hex_ext, standardized = TRUE, fit = TRUE)
```

Fit is subpar. Let's inspect.

```{r}
modindices(fit_hex_ext, minimum.value = 50)
```

One clear cross-loading emerges plus one covariance.

- 	HEX_EXT_SOC	=~	HEX_EXT_BOL_02
-   HEX_EXT_SSE_01	~~	HEX_EXT_LIV_02

```{r}
model_hex_ext <- "
HEX_EXT =~ HEX_EXT_SSE + HEX_EXT_BOL + HEX_EXT_SOC + HEX_EXT_LIV
HEX_EXT_SSE =~ HEX_EXT_SSE_01 + HEX_EXT_SSE_02 + HEX_EXT_SSE_03 + HEX_EXT_SSE_04
HEX_EXT_BOL =~ HEX_EXT_BOL_01 + HEX_EXT_BOL_02 + HEX_EXT_BOL_03 + HEX_EXT_BOL_04
HEX_EXT_SOC =~ HEX_EXT_SOC_01 + HEX_EXT_SOC_02 + HEX_EXT_SOC_03 + HEX_EXT_SOC_04 + HEX_EXT_BOL_02
HEX_EXT_LIV =~ HEX_EXT_LIV_01 + HEX_EXT_LIV_02 + HEX_EXT_LIV_03 + HEX_EXT_LIV_04

HEX_EXT_SSE_01 ~~ HEX_EXT_SSE_04
HEX_EXT_SSE_02 ~~ HEX_EXT_SSE_03
HEX_EXT_BOL_01 ~~ HEX_EXT_BOL_04
HEX_EXT_BOL_02 ~~ HEX_EXT_BOL_03
HEX_EXT_LIV_01 ~~ HEX_EXT_LIV_03
HEX_EXT_LIV_02 ~~ HEX_EXT_LIV_04
HEX_EXT_SSE_01 ~~	HEX_EXT_LIV_02
"
fit_hex_ext <- sem(model_hex_ext, d, estimator = "MLM", fixed.x = TRUE)
summary(fit_hex_ext, standardized = TRUE, fit = TRUE)
```

Fit not great, but improved.

### Agreeableness
#### Forgiveness

 1. I rarely hold a grudge, even against people who have badly wronged me.
 1. My attitude toward people who have treated me badly is "forgive and forget".
 1. If someone has cheated me once, I will always feel suspicious of that person.
 1. I find it hard to fully forgive someone who has done something mean to me.

```{r}
name <- "HEX_AGR_FOR"

plot_hist(name)
```


```{r}
mardia(
  select(
    d, paste0(rep(paste0(name, "_0"), 4), 1:4)
  )
)
```

Assumption of multivariate normality violated. Hence we'll use the robust estimator.

```{r}
model <- "
  HEX_AGR_FOR =~ HEX_AGR_FOR_01 + HEX_AGR_FOR_02 + HEX_AGR_FOR_03 + HEX_AGR_FOR_04
"

assign(
  paste("fit", name, sep = "_"), 
  cfa(model, d, estimator = "MLM")
  )

summary(get(paste0("fit_", name)), fit = TRUE, standardized = TRUE)
```

Fit is good.

#### Gentleness

 1. People sometimes tell me that I am too critical of others.
 1. I generally accept people’s faults without complaining about them.
 1. I tend to be lenient in judging other people.
 1. Even when people make a lot of mistakes, I rarely say anything negative.
 
```{r}
name <- "HEX_AGR_GEN"

plot_hist(name)
```


```{r}
mardia(
  select(
    d, paste0(rep(paste0(name, "_0"), 4), 1:4)
  )
)
```

Assumption of multivariate normality violated. Hence we'll use the robust estimator.

```{r}
model <- "
  HEX_AGR_GEN =~ HEX_AGR_GEN_01 + HEX_AGR_GEN_02 + HEX_AGR_GEN_03 + HEX_AGR_GEN_04
"

assign(
  paste("fit", name, sep = "_"), 
  cfa(model, d, estimator = "MLM")
  )

summary(get(paste0("fit_", name)), fit = TRUE, standardized = TRUE)
```

Fit is okay.

#### Flexibility

 1. People sometimes tell me that I'm too stubborn.
 1. I am usually quite flexible in my opinions when people disagree with me.
 1. When people tell me that I’m wrong, my first reaction is to argue with them.
 1. I find it hard to compromise with people when I really think I’m right.

```{r}
name <- "HEX_AGR_FLX"

plot_hist(name)
```


```{r}
mardia(
  select(
    d, paste0(rep(paste0(name, "_0"), 4), 1:4)
  )
)
```

Assumption of multivariate normality violated. Hence we'll use the robust estimator.

```{r}
model <- "
  HEX_AGR_FLX =~ HEX_AGR_FLX_01 + HEX_AGR_FLX_02 + HEX_AGR_FLX_03 + HEX_AGR_FLX_04
"

assign(
  paste("fit", name, sep = "_"), 
  cfa(model, d, estimator = "MLM")
  )

summary(get(paste0("fit_", name)), fit = TRUE, standardized = TRUE)
```

Fit is okay.

#### Patience

 1. People think of me as someone who has a quick temper.
 1. I rarely feel anger, even when people treat me quite badly.
 1. Most people tend to get angry more quickly than I do.
 1. I find it hard to keep my temper when people insult me.

```{r}
name <- "HEX_AGR_PAT"

plot_hist(name)
```


```{r}
mardia(
  select(
    d, paste0(rep(paste0(name, "_0"), 4), 1:4)
  )
)
```

Assumption of multivariate normality violated. Hence we'll use the robust estimator.

```{r}
model <- "
  HEX_AGR_PAT =~ HEX_AGR_PAT_01 + HEX_AGR_PAT_02 + HEX_AGR_PAT_03 + HEX_AGR_PAT_04
"

assign(
  paste("fit", name, sep = "_"), 
  cfa(model, d, estimator = "MLM")
  )

summary(get(paste0("fit_", name)), fit = TRUE, standardized = TRUE)
```

Fit is subpar. Let's check for potential improvements.

```{r}
modindices(fit_HEX_AGR_PAT)
```

Items 1 & 2 and Items 3 & 4 want to covary.

```{r}
model <- "
HEX_AGR_PAT =~ HEX_AGR_PAT_01 + HEX_AGR_PAT_02 + HEX_AGR_PAT_03 + HEX_AGR_PAT_04
HEX_AGR_PAT_01 ~~ a*HEX_AGR_PAT_02
HEX_AGR_PAT_03 ~~ a*HEX_AGR_PAT_04
"

assign(
  paste("fit", name, sep = "_"), 
  cfa(model, d, estimator = "MLM")
  )

summary(get(paste0("fit_", name)), fit = TRUE, standardized = TRUE)
```

Fit is good.

#### Agreeableness

Let's analyze main model.

```{r}
model_hex_agr <- "
HEX_AGR =~ HEX_AGR_FOR + HEX_AGR_GEN + HEX_AGR_FLX + HEX_AGR_PAT
HEX_AGR_FOR =~ HEX_AGR_FOR_01 + HEX_AGR_FOR_02 + HEX_AGR_FOR_03 + HEX_AGR_FOR_04
HEX_AGR_GEN =~ HEX_AGR_GEN_01 + HEX_AGR_GEN_02 + HEX_AGR_GEN_03 + HEX_AGR_GEN_04
HEX_AGR_FLX =~ HEX_AGR_FLX_01 + HEX_AGR_FLX_02 + HEX_AGR_FLX_03 + HEX_AGR_FLX_04
HEX_AGR_PAT =~ HEX_AGR_PAT_01 + HEX_AGR_PAT_02 + HEX_AGR_PAT_03 + HEX_AGR_PAT_04

HEX_AGR_PAT_01 ~~ HEX_AGR_PAT_02
HEX_AGR_PAT_03 ~~ HEX_AGR_PAT_04
"
fit_hex_agr <- sem(model_hex_agr, d, estimator = "MLM", fixed.x = TRUE)
summary(fit_hex_agr, standardized = TRUE, fit = TRUE)
```

Fit subpar, let's inspect.

```{r}
modindices(fit_hex_agr, minimum.value = 50)
```

One cross-loading and one covariance emerges.

- 	HEX_AGR_FOR	=~	HEX_AGR_PAT_02
-   HEX_AGR_GEN_01	~~	HEX_AGR_FLX_01

```{r}
model_hex_agr <- "
HEX_AGR =~ HEX_AGR_FOR + HEX_AGR_GEN + HEX_AGR_FLX + HEX_AGR_PAT
HEX_AGR_FOR =~ HEX_AGR_FOR_01 + HEX_AGR_FOR_02 + HEX_AGR_FOR_03 + HEX_AGR_FOR_04 + HEX_AGR_PAT_02
HEX_AGR_GEN =~ HEX_AGR_GEN_01 + HEX_AGR_GEN_02 + HEX_AGR_GEN_03 + HEX_AGR_GEN_04
HEX_AGR_FLX =~ HEX_AGR_FLX_01 + HEX_AGR_FLX_02 + HEX_AGR_FLX_03 + HEX_AGR_FLX_04
HEX_AGR_PAT =~ HEX_AGR_PAT_01 + HEX_AGR_PAT_02 + HEX_AGR_PAT_03 + HEX_AGR_PAT_04

HEX_AGR_PAT_01 ~~ HEX_AGR_PAT_02
HEX_AGR_PAT_03 ~~ HEX_AGR_PAT_04
HEX_AGR_GEN_01	~~	HEX_AGR_FLX_01
"
fit_hex_agr <- sem(model_hex_agr, d, estimator = "MLM", fixed.x = TRUE)
summary(fit_hex_agr, standardized = TRUE, fit = TRUE)
```

Fit is now quite good.

### Conscientiousness
#### Organization

 1. I clean my office or home quite frequently.
 1. I plan ahead and organize things, to avoid scrambling at the last minute.
 1. People often joke with me about the messiness of my room or desk.
 1. When working, I sometimes have difficulties due to being disorganized.

```{r}
name <- "HEX_CNS_ORG"

plot_hist(name)
```


```{r}
mardia(
  select(
    d, paste0(rep(paste0(name, "_0"), 4), 1:4)
  )
)
```

Assumption of multivariate normality violated. Hence we'll use the robust estimator.

```{r}
model <- "
  HEX_CNS_ORG =~ HEX_CNS_ORG_01 + HEX_CNS_ORG_02 + HEX_CNS_ORG_03 + HEX_CNS_ORG_04
"

assign(
  paste("fit", name, sep = "_"), 
  cfa(model, d, estimator = "MLM")
  )

summary(get(paste0("fit_", name)), fit = TRUE, standardized = TRUE)
```

Fit only "just" above thresholds. 
#### Diligence

 1. When working, I often set ambitious goals for myself.
 1. I often push myself very hard when trying to achieve a goal.
 1. Often when I set a goal, I end up quitting without having reached it.
 1. I do only the minimum amount of work needed to get by.

```{r}
name <- "HEX_CNS_DIL"

plot_hist(name)


mardia(
  select(
    d, paste0(rep(paste0(name, "_0"), 4), 1:4)
  )
)
```

Assumption of multivariate normality violated. Hence we should use the robust estimator. However, if we do so, one participant will be excluded, because MLM doesn't allow imputation. Will hence use ML but with FIML imputation.

```{r}
model <- "
  HEX_CNS_DIL =~ HEX_CNS_DIL_01 + HEX_CNS_DIL_02 + HEX_CNS_DIL_03 + HEX_CNS_DIL_04
"

assign(
  paste("fit", name, sep = "_"), 
  cfa(model, d, estimator = "MLR", missing = "FIML")
  )

summary(get(paste0("fit_", name)), fit = TRUE, standardized = TRUE)
```

Fit is bad. Let's inspect.

```{r}
modindices(fit_HEX_CNS_DIL)
```

Items 1 & 2, and items 3 & 4 want to covary.

```{r}
model <- "
  HEX_CNS_DIL =~ HEX_CNS_DIL_01 + HEX_CNS_DIL_02 + HEX_CNS_DIL_03 + HEX_CNS_DIL_04
  HEX_CNS_DIL_01 ~~ a*HEX_CNS_DIL_02
  HEX_CNS_DIL_03 ~~ a*HEX_CNS_DIL_04
"

assign(
  paste("fit", name, sep = "_"), 
  cfa(model, d, estimator = "MLR", missing = "FIML")
  )

summary(get(paste0("fit_", name)), fit = TRUE, standardized = TRUE)
```

Fit is now good.

#### Perfectionism

 1. I often check my work over repeatedly to find any mistakes.
 1. When working on something, I don't pay much attention to small details.
 1. I always try to be accurate in my work, even at the expense of time.
 1. People often call me a perfectionist.

```{r}
name <- "HEX_CNS_PER"

plot_hist(name)
```


```{r}
mardia(
  select(
    d, paste0(rep(paste0(name, "_0"), 4), 1:4)
  )
)
```

Assumption of multivariate normality violated. Hence we'll use the robust estimator.

```{r}
model <- "
  HEX_CNS_PER =~ HEX_CNS_PER_01 + HEX_CNS_PER_02 + HEX_CNS_PER_03 + HEX_CNS_PER_04
"

assign(
  paste("fit", name, sep = "_"), 
  cfa(model, d, estimator = "MLM")
  )

summary(get(paste0("fit_", name)), fit = TRUE, standardized = TRUE)
```

Fit subpar, needs to be improved.

```{r}
modindices(fit_HEX_CNS_PER)
```

Items 1 & 4 and items 2 & 3 want to covary.


```{r}
model <- "
  HEX_CNS_PER =~ HEX_CNS_PER_01 + HEX_CNS_PER_02 + HEX_CNS_PER_03 + HEX_CNS_PER_04
  HEX_CNS_PER_01 ~~ a*HEX_CNS_PER_04
  HEX_CNS_PER_02 ~~ a*HEX_CNS_PER_03
"

assign(
  paste("fit", name, sep = "_"), 
  cfa(model, d, estimator = "MLM")
  )

summary(get(paste0("fit_", name)), fit = TRUE, standardized = TRUE)
```

Fit is now great.

#### Prudence

 1. I make decisions based on the feeling of the moment rather than on careful thought.
 1. I make a lot of mistakes because I don't think before I act.
 1. I don’t allow my impulses to govern my behavior.
 1. I prefer to do whatever comes to mind, rather than stick to a plan.
 
```{r}
name <- "HEX_CNS_PRU"

plot_hist(name)
```


```{r}
mardia(
  select(
    d, paste0(rep(paste0(name, "_0"), 4), 1:4)
  )
)
```

Assumption of multivariate normality violated. Hence we'll use the robust estimator.

```{r}
model <- "
  HEX_CNS_PRU =~ HEX_CNS_PRU_01 + HEX_CNS_PRU_02 + HEX_CNS_PRU_03 + HEX_CNS_PRU_04
"

assign(
  paste("fit", name, sep = "_"), 
  cfa(model, d, estimator = "MLM")
  )

summary(get(paste0("fit_", name)), fit = TRUE, standardized = TRUE)
```

Although not great, fit is within of thresholds.

#### Conscientiousness

Let's analyze main model as well.

```{r}
model_hex_cns <- "
HEX_CNS =~ HEX_CNS_ORG + HEX_CNS_DIL + HEX_CNS_PER + HEX_CNS_PRU
HEX_CNS_ORG =~ HEX_CNS_ORG_01 + HEX_CNS_ORG_02 + HEX_CNS_ORG_03 + HEX_CNS_ORG_04
HEX_CNS_DIL =~ HEX_CNS_DIL_01 + HEX_CNS_DIL_02 + HEX_CNS_DIL_03 + HEX_CNS_DIL_04
HEX_CNS_PER =~ HEX_CNS_PER_01 + HEX_CNS_PER_02 + HEX_CNS_PER_03 + HEX_CNS_PER_04
HEX_CNS_PRU =~ HEX_CNS_PRU_01 + HEX_CNS_PRU_02 + HEX_CNS_PRU_03 + HEX_CNS_PRU_04

HEX_CNS_ORG_01 ~~ HEX_CNS_ORG_04
HEX_CNS_ORG_02 ~~ HEX_CNS_ORG_03
HEX_CNS_DIL_01 ~~ HEX_CNS_DIL_02
HEX_CNS_DIL_03 ~~ HEX_CNS_DIL_04
HEX_CNS_PER_01 ~~ HEX_CNS_PER_04
HEX_CNS_PER_02 ~~ HEX_CNS_PER_03
HEX_CNS_PRU_01 ~~ HEX_CNS_PRU_04
HEX_CNS_PRU_02 ~~ HEX_CNS_PRU_03
"
fit_hex_cns <- sem(model_hex_cns, d, estimator = "MLM", fixed.x = TRUE)
summary(fit_hex_cns, standardized = TRUE, fit = TRUE)
```

Fit is slightly below thresholds, let's inspect.

```{r}
modindices(fit_hex_cns, minimum.value = 50)
```

No real candidate emerges. Will keep that way.

### Openness
#### Aesthetic Appreciation

 1. I would be quite bored by a visit to an art gallery.
 1. I wouldn't spend my time reading a book of poetry.
 1. If I had the opportunity, I would like to attend a classical music concert.
 1. Sometimes I like to just watch the wind as it blows through the trees.
 
```{r}
name <- "HEX_OPN_AES"

plot_hist(name)
```


```{r}
mardia(
  select(
    d, paste0(rep(paste0(name, "_0"), 4), 1:4)
  )
)
```

Assumption of multivariate normality violated. Hence we'll use the robust estimator.

```{r}
model <- "
  HEX_OPN_AES =~ HEX_OPN_AES_01 + HEX_OPN_AES_02 + HEX_OPN_AES_03 + HEX_OPN_AES_04
"

assign(
  paste("fit", name, sep = "_"), 
  cfa(model, d, estimator = "MLM")
  )

summary(get(paste0("fit_", name)), fit = TRUE, standardized = TRUE)
```

Fit is good.

#### Inquisitiveness

 1. I'm interested in learning about the history and politics of other countries.
 1. I enjoy looking at maps of different places.
 1. I would be very bored by a book about the history of science and technology.
 1. I’ve never really enjoyed looking through an encyclopedia.
 
```{r}
name <- "HEX_OPN_INQ"

plot_hist(name)
```


```{r}
mardia(
  select(
    d, paste0(rep(paste0(name, "_0"), 4), 1:4)
  )
)
```

Assumption of multivariate normality violated. Hence we'll use the robust estimator.

```{r}
model <- "
  HEX_OPN_INQ =~ HEX_OPN_INQ_01 + HEX_OPN_INQ_02 + HEX_OPN_INQ_03 + HEX_OPN_INQ_04
"

assign(
  paste("fit", name, sep = "_"), 
  cfa(model, d, estimator = "MLM")
  )

summary(get(paste0("fit_", name)), fit = TRUE, standardized = TRUE)
```

Fit is just within thresholds.

#### Creativeness

 1. I would like a job that requires following a routine rather than being creative.
 1. I would enjoy creating a work of art, such as a novel, a song, or a painting.
 1. People have often told me that I have a good imagination.
 1. I don't think of myself as the artistic or creative type.

```{r}
name <- "HEX_OPN_CRE"

plot_hist(name)
```


```{r}
mardia(
  select(
    d, paste0(rep(paste0(name, "_0"), 4), 1:4)
  )
)
```

Assumption of multivariate normality violated. Hence we'll use the robust estimator.

```{r}
model <- "
  HEX_OPN_CRE =~ HEX_OPN_CRE_01 + HEX_OPN_CRE_02 + HEX_OPN_CRE_03 + HEX_OPN_CRE_04
"

assign(
  paste("fit", name, sep = "_"), 
  cfa(model, d, estimator = "MLM")
  )

summary(get(paste0("fit_", name)), fit = TRUE, standardized = TRUE)
```

Fit is great.

#### Unconventionality

 1. I think that paying attention to radical ideas is a waste of time.
 1. I like people who have unconventional views.
 1. I think of myself as a somewhat eccentric person.
 1. I find it boring to discuss philosophy.
 
```{r}
name <- "HEX_OPN_UNC"

plot_hist(name)
```


```{r}
mardia(
  select(
    d, paste0(rep(paste0(name, "_0"), 4), 1:4)
  )
)
```

Assumption of multivariate normality violated. Hence we'll use the robust estimator.

```{r}
model <- "
  HEX_OPN_UNC =~ HEX_OPN_UNC_01 + HEX_OPN_UNC_02 + HEX_OPN_UNC_03 + HEX_OPN_UNC_04
"

assign(
  paste("fit", name, sep = "_"), 
  cfa(model, d, estimator = "MLR", missing = "FIML")
  )

summary(get(paste0("fit_", name)), fit = TRUE, standardized = TRUE)
```

Fit is subpar. Let's inspect.

```{r}
modindices(fit_HEX_OPN_UNC)
```

Items 1 & 4 and items 2 & 3 want to covary.

```{r}
model <- "
  HEX_OPN_UNC =~ HEX_OPN_UNC_01 + HEX_OPN_UNC_02 + HEX_OPN_UNC_03 + HEX_OPN_UNC_04
  HEX_OPN_UNC_01 ~~ a*HEX_OPN_UNC_04
  HEX_OPN_UNC_02 ~~ a*HEX_OPN_UNC_03
"

assign(
  paste("fit", name, sep = "_"), 
  cfa(model, d, estimator = "MLR", missing = "FIML")
  )

summary(get(paste0("fit_", name)), fit = TRUE, standardized = TRUE)
```

Fit is now great.

#### Openness

Let's analyze main model as well.

```{r}
model_hex_opn <- "
HEX_OPN =~ HEX_OPN_AES + HEX_OPN_INQ + HEX_OPN_CRE + HEX_OPN_UNC
HEX_OPN_AES =~ HEX_OPN_AES_01 + HEX_OPN_AES_02 + HEX_OPN_AES_03 + HEX_OPN_AES_04
HEX_OPN_INQ =~ HEX_OPN_INQ_01 + HEX_OPN_INQ_02 + HEX_OPN_INQ_03 + HEX_OPN_INQ_04
HEX_OPN_CRE =~ HEX_OPN_CRE_01 + HEX_OPN_CRE_02 + HEX_OPN_CRE_03 + HEX_OPN_CRE_04
HEX_OPN_UNC =~ HEX_OPN_UNC_01 + HEX_OPN_UNC_02 + HEX_OPN_UNC_03 + HEX_OPN_UNC_04

HEX_OPN_INQ_01 ~~ HEX_OPN_INQ_04
HEX_OPN_INQ_02 ~~ HEX_OPN_INQ_03
HEX_OPN_UNC_01 ~~ HEX_OPN_UNC_04
HEX_OPN_UNC_02 ~~ HEX_OPN_UNC_03
"
fit_hex_opn <- sem(model_hex_opn, d, estimator = "MLM", fixed.x = TRUE)
summary(fit_hex_opn, standardized = TRUE, fit = TRUE)
```

### Altruism

 1. I have sympathy for people who are less fortunate than I am.
 1. I try to give generously to those in need.
 1. It wouldn’t bother me to harm someone I didn’t like.
 1. People see me as a hard-hearted person.
 
```{r}
name <- "HEX_ALT"

plot_hist(name)
```


```{r}
mardia(
  select(
    d, paste0(rep(paste0(name, "_0"), 4), 1:4)
  )
)
```

Assumption of multivariate normality violated. Hence we'll use the robust estimator.

```{r}
model <- "
  HEX_ALT =~ HEX_ALT_01 + HEX_ALT_02 + HEX_ALT_03 + HEX_ALT_04
"

assign(
  paste("fit", name, sep = "_"), 
  cfa(model, d, estimator = "MLM")
  )

summary(get(paste0("fit_", name)), fit = TRUE, standardized = TRUE)
```

Fit is subpar. Let's inspect.

```{r}
modindices(fit_HEX_ALT)
```

Items 1 & 2 and items 3 & 4 want to covary.

```{r}
model <- "
  HEX_ALT =~ HEX_ALT_01 + HEX_ALT_02 + HEX_ALT_03 + HEX_ALT_04
  HEX_ALT_01 ~~ a*HEX_ALT_02
  HEX_ALT_03 ~~ a*HEX_ALT_04
"

assign(
  paste("fit", name, sep = "_"), 
  cfa(model, d, estimator = "MLM")
  )

summary(get(paste0("fit_", name)), fit = TRUE, standardized = TRUE)
```

Fit is now good.

### Hexaco Model

```{r hex-model}
model_hex <- "
HEX_HOH =~ HEX_HOH_SIN + HEX_HOH_FAI + HEX_HOH_GRE + HEX_HOH_MOD
HEX_EMO =~ HEX_EMO_FEA + HEX_EMO_ANX + HEX_EMO_DEP + HEX_EMO_SEN
HEX_EXT =~ HEX_EXT_SSE + HEX_EXT_BOL + HEX_EXT_SOC + HEX_EXT_LIV
HEX_AGR =~ HEX_AGR_FOR + HEX_AGR_GEN + HEX_AGR_FLX + HEX_AGR_PAT
HEX_CNS =~ HEX_CNS_ORG + HEX_CNS_DIL + HEX_CNS_PER + HEX_CNS_PRU
HEX_OPN =~ HEX_OPN_AES + HEX_OPN_INQ + HEX_OPN_CRE + HEX_OPN_UNC

HEX_HOH_SIN =~ HEX_HOH_SIN_01 + HEX_HOH_SIN_02 + HEX_HOH_SIN_03 + HEX_HOH_SIN_04
HEX_HOH_FAI =~ HEX_HOH_FAI_01 + HEX_HOH_FAI_02 + HEX_HOH_FAI_03 + HEX_HOH_FAI_04
HEX_HOH_GRE =~ HEX_HOH_GRE_01 + HEX_HOH_GRE_02 + HEX_HOH_GRE_03 + HEX_HOH_GRE_04
HEX_HOH_MOD =~ HEX_HOH_MOD_01 + HEX_HOH_MOD_02 + HEX_HOH_MOD_03 + HEX_HOH_MOD_04

HEX_EMO_FEA =~ HEX_EMO_FEA_01 + HEX_EMO_FEA_02 + HEX_EMO_FEA_03 + HEX_EMO_FEA_04
HEX_EMO_ANX =~ HEX_EMO_ANX_01 + HEX_EMO_ANX_02 + HEX_EMO_ANX_03 + HEX_EMO_ANX_04 + HEX_EMO_FEA_04
HEX_EMO_DEP =~ HEX_EMO_DEP_01 + HEX_EMO_DEP_02 + HEX_EMO_DEP_03 + HEX_EMO_DEP_04
HEX_EMO_SEN =~ HEX_EMO_SEN_01 + HEX_EMO_SEN_02 + HEX_EMO_SEN_03 + HEX_EMO_SEN_04

HEX_EXT_SSE =~ HEX_EXT_SSE_01 + HEX_EXT_SSE_02 + HEX_EXT_SSE_03 + HEX_EXT_SSE_04
HEX_EXT_BOL =~ HEX_EXT_BOL_01 + HEX_EXT_BOL_02 + HEX_EXT_BOL_03 + HEX_EXT_BOL_04
HEX_EXT_SOC =~ HEX_EXT_SOC_01 + HEX_EXT_SOC_02 + HEX_EXT_SOC_03 + HEX_EXT_SOC_04 + HEX_EXT_BOL_02
HEX_EXT_LIV =~ HEX_EXT_LIV_01 + HEX_EXT_LIV_02 + HEX_EXT_LIV_03 + HEX_EXT_LIV_04

HEX_AGR_FOR =~ HEX_AGR_FOR_01 + HEX_AGR_FOR_02 + HEX_AGR_FOR_03 + HEX_AGR_FOR_04 + HEX_AGR_PAT_02
HEX_AGR_GEN =~ HEX_AGR_GEN_01 + HEX_AGR_GEN_02 + HEX_AGR_GEN_03 + HEX_AGR_GEN_04
HEX_AGR_FLX =~ HEX_AGR_FLX_01 + HEX_AGR_FLX_02 + HEX_AGR_FLX_03 + HEX_AGR_FLX_04
HEX_AGR_PAT =~ HEX_AGR_PAT_01 + HEX_AGR_PAT_02 + HEX_AGR_PAT_03 + HEX_AGR_PAT_04

HEX_CNS_ORG =~ HEX_CNS_ORG_01 + HEX_CNS_ORG_02 + HEX_CNS_ORG_03 + HEX_CNS_ORG_04
HEX_CNS_DIL =~ HEX_CNS_DIL_01 + HEX_CNS_DIL_02 + HEX_CNS_DIL_03 + HEX_CNS_DIL_04
HEX_CNS_PER =~ HEX_CNS_PER_01 + HEX_CNS_PER_02 + HEX_CNS_PER_03 + HEX_CNS_PER_04
HEX_CNS_PRU =~ HEX_CNS_PRU_01 + HEX_CNS_PRU_02 + HEX_CNS_PRU_03 + HEX_CNS_PRU_04

HEX_OPN_AES =~ HEX_OPN_AES_01 + HEX_OPN_AES_02 + HEX_OPN_AES_03 + HEX_OPN_AES_04
HEX_OPN_INQ =~ HEX_OPN_INQ_01 + HEX_OPN_INQ_02 + HEX_OPN_INQ_03 + HEX_OPN_INQ_04
HEX_OPN_CRE =~ HEX_OPN_CRE_01 + HEX_OPN_CRE_02 + HEX_OPN_CRE_03 + HEX_OPN_CRE_04
HEX_OPN_UNC =~ HEX_OPN_UNC_01 + HEX_OPN_UNC_02 + HEX_OPN_UNC_03 + HEX_OPN_UNC_04

# Covariances
HEX_HOH_SIN_01 ~~ HEX_HOH_SIN_03
HEX_HOH_SIN_02 ~~ HEX_HOH_SIN_04
HEX_HOH_GRE_01 ~~ HEX_HOH_GRE_02
HEX_HOH_GRE_03 ~~ HEX_HOH_GRE_04
HEX_EMO_DEP_01 ~~ HEX_EMO_DEP_04
HEX_EMO_DEP_02 ~~ HEX_EMO_DEP_03
HEX_EMO_SEN_01 ~~ HEX_EMO_SEN_03
HEX_EMO_SEN_02 ~~ HEX_EMO_SEN_04
HEX_EXT_SSE_01 ~~ HEX_EXT_SSE_04
HEX_EXT_SSE_02 ~~ HEX_EXT_SSE_03
HEX_EXT_BOL_01 ~~ HEX_EXT_BOL_04
HEX_EXT_BOL_02 ~~ HEX_EXT_BOL_03
HEX_EXT_LIV_01 ~~ HEX_EXT_LIV_03
HEX_EXT_LIV_02 ~~ HEX_EXT_LIV_04
HEX_AGR_PAT_01 ~~ HEX_AGR_PAT_02
HEX_AGR_PAT_03 ~~ HEX_AGR_PAT_04
HEX_CNS_PER_01 ~~ HEX_CNS_PER_04
HEX_CNS_PER_02 ~~ HEX_CNS_PER_03
HEX_CNS_DIL_01 ~~ HEX_CNS_DIL_02
HEX_CNS_DIL_03 ~~ HEX_CNS_DIL_04
HEX_OPN_UNC_01 ~~ HEX_OPN_UNC_04
HEX_OPN_UNC_02 ~~ HEX_OPN_UNC_03
HEX_AGR_GEN_01	~~	HEX_AGR_FLX_01
"
fit_hex <- sem(model_hex, d, estimator = "MLM", fixed.x = TRUE)
summary(fit_hex, standardized = TRUE, fit = TRUE)
```

Model throws a warning: Negative variance. Also several Heywood cases included. Shows that latent is not working. 

Hence, let's not extract the factor scores for the personality dimensions, but rather calculate mean scores.

## Need for privacy
### Psychological

 1.	I don’t like to talk about personal issues with others unless they do it first.
 2.	There are a lot of things about me that I don’t like to talk about with others.
 3.	I prefer not to share my feelings and inner thoughts with others.
 4.	I don't like it when others talk to me about their private issues.

```{r}
name <- "NFP_PSY"

plot_hist(name)
```


```{r}
mardia(
  select(
    d, paste0(rep(paste0(name, "_0"), 4), 1:4)
  )
)
```

Assumption of multivariate normality violated. Hence we'll use the robust estimator.

```{r}
model <- "
  NFP_PSY =~ NFP_PSY_01 + NFP_PSY_02 + NFP_PSY_03 + NFP_PSY_04
"

assign(
  paste("fit", name, sep = "_"), 
  cfa(model, d, estimator = "MLM")
  )

summary(get(paste0("fit_", name)), fit = TRUE, standardized = TRUE)
```

Fit is great.

### Physical

 1.	I don’t like it when strangers come too close to me.
 2.	I don’t like to stand in a dense crowd of people.
 3.	I don’t like to sit next to a stranger on a train, bus, or plane.
 4.	I hate it when people enter my personal space uninvited.

```{r}
name <- "NFP_PHY"

plot_hist(name)
```


```{r}
mardia(
  select(
    d, paste0(rep(paste0(name, "_0"), 4), 1:4)
  )
)
```

Assumption of multivariate normality violated. Hence we'll use the robust estimator.

```{r}
model <- "
  NFP_PHY =~ NFP_PHY_01 + NFP_PHY_02 + NFP_PHY_03 + NFP_PHY_04
"

assign(
  paste("fit", name, sep = "_"), 
  cfa(model, d, estimator = "MLM")
  )

summary(get(paste0("fit_", name)), fit = TRUE, standardized = TRUE)
```

Fit is great.

### Social

 1.	I don’t feel comfortable interacting with other people.
 2.	I often want to be alone.
 3.	I’m a fairly anti-social person.
 4.	I prefer to work independently in most situations.

```{r}
name <- "NFP_SOC"

plot_hist(name)
```


```{r}
mardia(
  select(
    d, paste0(rep(paste0(name, "_0"), 4), 1:4)
  )
)
```

Assumption of multivariate normality violated. Hence we'll use the robust estimator.

```{r}
model <- "
  NFP_SOC =~ NFP_SOC_01 + NFP_SOC_02 + NFP_SOC_03 + NFP_SOC_04
"

assign(
  paste("fit", name, sep = "_"), 
  cfa(model, d, estimator = "MLM")
  )

summary(get(paste0("fit_", name)), fit = TRUE, standardized = TRUE)
```

Fit isn't that good. Let's inspect.

```{r}
modindices(fit_NFP_SOC)
```

Items 1 & 3 and items 2 & 4 want to covary.

```{r}
model <- "
  NFP_SOC =~ NFP_SOC_01 + NFP_SOC_02 + NFP_SOC_03 + NFP_SOC_04
  NFP_SOC_01 ~~ p1*NFP_SOC_03
  NFP_SOC_02 ~~ p1*NFP_SOC_04
"

assign(
  paste("fit", name, sep = "_"), 
  cfa(model, d, estimator = "MLM")
  )

summary(get(paste0("fit_", name)), fit = TRUE, standardized = TRUE)
```

Fit is great.

### Privacy from Government

 1.	I need government agencies to respect my privacy, even if that makes catching criminals harder.
 2.	I don’t want the government to gather data about me, even if that makes it harder to spend tax income effectively.
 3.	I don’t want government agencies to monitor my communication, even if that stops terrorist attacks.
 4.	I feel I need to protect my privacy from government agencies.

```{r}
name <- "NFP_GOV"

plot_hist(name)
```


```{r}
mardia(
  select(
    d, paste0(rep(paste0(name, "_0"), 4), 1:4)
  )
)
```

Assumption of multivariate normality violated. Hence we'll use the robust estimator.

```{r}
model <- "
  NFP_GOV =~ NFP_GOV_01 + NFP_GOV_02 + NFP_GOV_03 + NFP_GOV_04
"

assign(
  paste("fit", name, sep = "_"), 
  cfa(model, d, estimator = "MLR", missing = "FIML")
  )

summary(get(paste0("fit_", name)), fit = TRUE, standardized = TRUE)
```

Fit is not optimal, but within thresholds.

### Privacy from Companies

 1. I’m willing to pay more for products or services so that companies don’t have to sell my data.
 2. I’m happy to give up a little bit of privacy so that I can use certain apps or services for free.
 3. I don’t want companies to collect data about me, even if that makes their services worse.
 4. I feel I need to protect my privacy from companies.

```{r}
name <- "NFP_COM"

plot_hist(name)
```


```{r}
mardia(
  select(
    d, paste0(rep(paste0(name, "_0"), 4), 1:4)
  )
)
```

Assumption of multivariate normality violated. Hence we'll use the robust estimator.

```{r}
model <- "
  NFP_COM =~ NFP_COM_01 + NFP_COM_02 + NFP_COM_03 + NFP_COM_04
"

assign(
  paste("fit", name, sep = "_"), 
  cfa(model, d, estimator = "MLM")
  )

summary(get(paste0("fit_", name)), fit = TRUE, standardized = TRUE)
```

Fit is not great but sufficiently okay.

### Informational

 1.	I would prefer that little is known about me.
 2.	I don’t want my personal data to be publicly accessible.
 3.	It is important to me that records pertaining to me remain confidential.
 4.	I prefer that others cannot easily find information about me on the Internet.

```{r}
name <- "NFP_INF"

plot_hist(name)
```


```{r}
mardia(
  select(
    d, paste0(rep(paste0(name, "_0"), 4), 1:4)
  )
)
```

Assumption of multivariate normality violated. Hence we'll use the robust estimator.

```{r}
model <- "
  NFP_INF =~ NFP_INF_01 + NFP_INF_02 + NFP_INF_03 + NFP_INF_04
"

assign(
  paste("fit", name, sep = "_"), 
  cfa(model, d, estimator = "MLM")
  )

summary(get(paste0("fit_", name)), fit = TRUE, standardized = TRUE)
```

Fit is suboptimal. Let's inspect.

```{r}
modindices(fit_NFP_INF)
```

Items 1 & 4 and items 2 & 3 want to covary.

```{r}
model <- "
  NFP_INF =~ NFP_INF_01 + NFP_INF_02 + NFP_INF_03 + NFP_INF_04
  NFP_INF_01 ~~ a*NFP_INF_04
  NFP_INF_02 ~~ a*NFP_INF_03
"

assign(
  paste("fit", name, sep = "_"), 
  cfa(model, d, estimator = "MLM")
  )

summary(get(paste0("fit_", name)), fit = TRUE, standardized = TRUE)
```

Fit is good.

### Privacy need anonymity

 1.	I would prefer to use a fake account on social network sites to preserve my privacy.
 2.	I feel I need to avoid places with video surveillance.
 3.	I prefer not to carry my driver’s license or ID with me all the time to preserve my privacy.
 4.	I need to be able to surf the Internet anonymously.

```{r}
name <- "NFP_ANO"

plot_hist(name)
```


```{r}
mardia(
  select(
    d, paste0(rep(paste0(name, "_0"), 4), 1:4)
  )
)
```

Assumption of multivariate normality violated. Hence we'll use the robust estimator.

```{r}
model <- "
  NFP_ANO =~ NFP_ANO_01 + NFP_ANO_02 + NFP_ANO_03 + NFP_ANO_04
"

assign(
  paste("fit", name, sep = "_"), 
  cfa(model, d, estimator = "MLM")
  )

summary(get(paste0("fit_", name)), fit = TRUE, standardized = TRUE)
```

Fit is really bad. Let's inspect.

```{r}
modindices(fit_NFP_ANO)
```

Items 1 & 4 and items 2 & 3 want to covary.

```{r}
model <- "
  NFP_ANO =~ NFP_ANO_01 + NFP_ANO_02 + NFP_ANO_03 + NFP_ANO_04
  NFP_ANO_01 ~~ a*NFP_ANO_04
  NFP_ANO_02 ~~ a*NFP_ANO_03
"

assign(
  paste("fit", name, sep = "_"), 
  cfa(model, d, estimator = "MLM")
  )

summary(get(paste0("fit_", name)), fit = TRUE, standardized = TRUE)
```

Fit is now good.

### General Need for privacy

 1.	I need a lot of privacy.
 2.	Privacy is very important to me.
 3.	I think a lot about how I can protect my privacy.
 4.	I value privacy a lot.
 
```{r}
name <- "NFP_GEN"

plot_hist(name)
```


```{r}
mardia(
  select(
    d, paste0(rep(paste0(name, "_0"), 4), 1:4)
  )
)
```

Assumption of multivariate normality violated. Hence we'll use the robust estimator.

```{r}
model <- "
  NFP_GEN =~ NFP_GEN_01 + NFP_GEN_02 + NFP_GEN_03 + NFP_GEN_04
"

assign(
  paste("fit", name, sep = "_"), 
  cfa(model, d, estimator = "MLR", missing = "FIML")
  )

summary(get(paste0("fit_", name)), fit = TRUE, standardized = TRUE)
```

Fit is good.

### Need for Privacy model

```{r nfp-model}
model_pri <- "
NFP_PHY =~ NFP_PHY_01 + NFP_PHY_02 + NFP_PHY_03 + NFP_PHY_04
NFP_PSY =~ NFP_PSY_01 + NFP_PSY_02 + NFP_PSY_03 + NFP_PSY_04
NFP_SOC =~ NFP_SOC_01 + NFP_SOC_02 + NFP_SOC_03 + NFP_SOC_04
NFP_COM =~ NFP_COM_01 + NFP_COM_02 + NFP_COM_03 + NFP_COM_04
NFP_GOV =~ NFP_GOV_01 + NFP_GOV_02 + NFP_GOV_03 + NFP_GOV_04
NFP_ANO =~ NFP_ANO_01 + NFP_ANO_02 + NFP_ANO_03 + NFP_ANO_04
NFP_INF =~ NFP_INF_01 + NFP_INF_02 + NFP_INF_03 + NFP_INF_04
NFP_GEN =~ NFP_GEN_01 + NFP_GEN_02 + NFP_GEN_03 + NFP_GEN_04

# Covariances
NFP_SOC_01 ~~ NFP_SOC_03
NFP_SOC_02 ~~ NFP_SOC_04
NFP_GOV_01 ~~ NFP_GOV_03
NFP_GOV_02 ~~ NFP_GOV_04
NFP_INF_01 ~~ NFP_INF_04
NFP_INF_02 ~~ NFP_INF_03
NFP_ANO_01 ~~ NFP_ANO_04
NFP_ANO_02 ~~ NFP_ANO_03
"
fit_pri <- sem(model_pri, d, estimator = "MLM", fixed.x = TRUE)
summary(fit_pri, standardized = TRUE, fit = TRUE)
```

Fit is actually quite good and only marginally below thresholds. Will inspect.

```{r}
modindices(fit_pri, minimum.value = 50)
```

Suggests several cross-loadings. Will integrate.

- NFP_PHY	=~	NFP_GEN_01
- NFP_PSY	=~	NFP_INF_01
- NFP_PSY	=~	NFP_GEN_01
- NFP_SOC	=~	NFP_INF_01
- NFP_SOC	=~	NFP_GEN_01

```{r}
model_pri <- "
NFP_PHY =~ NFP_PHY_01 + NFP_PHY_02 + NFP_PHY_03 + NFP_PHY_04 + NFP_GEN_01
NFP_PSY =~ NFP_PSY_01 + NFP_PSY_02 + NFP_PSY_03 + NFP_PSY_04 + NFP_GEN_01 + NFP_INF_01
NFP_SOC =~ NFP_SOC_01 + NFP_SOC_02 + NFP_SOC_03 + NFP_SOC_04 + NFP_GEN_01 + NFP_INF_01
NFP_COM =~ NFP_COM_01 + NFP_COM_02 + NFP_COM_03 + NFP_COM_04
NFP_GOV =~ NFP_GOV_01 + NFP_GOV_02 + NFP_GOV_03 + NFP_GOV_04
NFP_ANO =~ NFP_ANO_01 + NFP_ANO_02 + NFP_ANO_03 + NFP_ANO_04
NFP_INF =~ NFP_INF_01 + NFP_INF_02 + NFP_INF_03 + NFP_INF_04
NFP_GEN =~ NFP_GEN_01 + NFP_GEN_02 + NFP_GEN_03 + NFP_GEN_04

# Covariances
NFP_SOC_01 ~~ NFP_SOC_03
NFP_SOC_02 ~~ NFP_SOC_04
NFP_GOV_01 ~~ NFP_GOV_03
NFP_GOV_02 ~~ NFP_GOV_04
NFP_INF_01 ~~ NFP_INF_04
NFP_INF_02 ~~ NFP_INF_03
NFP_ANO_01 ~~ NFP_ANO_04
NFP_ANO_02 ~~ NFP_ANO_03
"
fit_pri <- sem(model_pri, d, estimator = "MLM", fixed.x = TRUE)
summary(fit_pri, standardized = TRUE, fit = TRUE)
```

Fit is now great.

## Convergent validity

To assess convergent validity, let's correlate measures with privacy concerns and privacy behavior.

```{r}
tab_conval <- 
  d %>% 
  select(
    all_of(paste0(vars_pri, "_M")), PRI_CON, PRI_BEH
  ) %>% 
  cor(use = "pairwise") %>% 
  round(2) %>% 
  as.data.frame %>% 
  select(PRI_CON, PRI_BEH)
tab_conval
```

Almost all variables showed high convergent validity.

## Export factor scores

To increase precision, we export the latents variables's factor scores as preregistered.

```{r factor-scores, cache=T}
d <- 
  d %>% 
  mutate(
    HEX_ALT_FS = lavPredict(fit_HEX_ALT),
    HEX_AGR_FLX_FS = lavPredict(fit_HEX_AGR_FLX),
    HEX_AGR_FOR_FS = lavPredict(fit_HEX_AGR_FOR),
    HEX_AGR_GEN_FS = lavPredict(fit_HEX_AGR_GEN),
    HEX_AGR_PAT_FS = lavPredict(fit_HEX_AGR_PAT),
    HEX_CNS_DIL_FS = lavPredict(fit_HEX_CNS_DIL),
    HEX_CNS_ORG_FS = lavPredict(fit_HEX_CNS_ORG),
    HEX_CNS_PER_FS = lavPredict(fit_HEX_CNS_PER),
    HEX_CNS_PRU_FS = lavPredict(fit_HEX_CNS_PRU),
    HEX_EMO_ANX_FS = lavPredict(fit_HEX_EMO_ANX),
    HEX_EMO_DEP_FS = lavPredict(fit_HEX_EMO_DEP),
    HEX_EMO_FEA_FS = lavPredict(fit_HEX_EMO_FEA),
    HEX_EMO_SEN_FS = lavPredict(fit_HEX_EMO_SEN),
    HEX_EXT_BOL_FS = lavPredict(fit_HEX_EXT_BOL),
    HEX_EXT_LIV_FS = lavPredict(fit_HEX_EXT_LIV),
    HEX_EXT_SOC_FS = lavPredict(fit_HEX_EXT_SOC),
    HEX_EXT_SSE_FS = lavPredict(fit_HEX_EXT_SSE),
    HEX_HOH_FAI_FS = lavPredict(fit_HEX_HOH_FAI),
    HEX_HOH_GRE_FS = lavPredict(fit_HEX_HOH_GRE),
    HEX_HOH_MOD_FS = lavPredict(fit_HEX_HOH_MOD),
    HEX_HOH_SIN_FS = lavPredict(fit_HEX_HOH_SIN),
    HEX_OPN_AES_FS = lavPredict(fit_HEX_OPN_AES),
    HEX_OPN_CRE_FS = lavPredict(fit_HEX_OPN_CRE),
    HEX_OPN_INQ_FS = lavPredict(fit_HEX_OPN_INQ),
    HEX_OPN_UNC_FS = lavPredict(fit_HEX_OPN_UNC),
    NFP_ANO_FS = lavPredict(fit_NFP_ANO),
    NFP_COM_FS = lavPredict(fit_NFP_COM),
    NFP_GEN_FS = lavPredict(fit_NFP_GEN),
    NFP_GOV_FS = lavPredict(fit_NFP_GOV),
    NFP_INF_FS = lavPredict(fit_NFP_INF),
    NFP_PHY_FS = lavPredict(fit_NFP_PHY),
    NFP_PSY_FS = lavPredict(fit_NFP_PSY),
    NFP_SOC_FS = lavPredict(fit_NFP_SOC)
  )
```

## Item errors

As preregistered, we also test analyses using observed mean measures of scales while accounting for their error variance. Hence, we estimate error variance according to Kline. 

```{r item-errors}
# Extract variance
HEX_ALT_var <- var(d$HEX_ALT_M, na.rm = T)
HEX_AGR_FLX_var <- var(d$HEX_AGR_FLX_M, na.rm = T)
HEX_AGR_FOR_var <- var(d$HEX_AGR_FOR_M, na.rm = T)
HEX_AGR_GEN_var <- var(d$HEX_AGR_GEN_M, na.rm = T)
HEX_AGR_PAT_var <- var(d$HEX_AGR_PAT_M, na.rm = T)
HEX_CNS_DIL_var <- var(d$HEX_CNS_DIL_M, na.rm = T)
HEX_CNS_ORG_var <- var(d$HEX_CNS_ORG_M, na.rm = T)
HEX_CNS_PER_var <- var(d$HEX_CNS_PER_M, na.rm = T)
HEX_CNS_PRU_var <- var(d$HEX_CNS_PRU_M, na.rm = T)
HEX_EMO_ANX_var <- var(d$HEX_EMO_ANX_M, na.rm = T)
HEX_EMO_DEP_var <- var(d$HEX_EMO_DEP_M, na.rm = T)
HEX_EMO_FEA_var <- var(d$HEX_EMO_FEA_M, na.rm = T)
HEX_EMO_SEN_var <- var(d$HEX_EMO_SEN_M, na.rm = T)
HEX_EXT_BOL_var <- var(d$HEX_EXT_BOL_M, na.rm = T)
HEX_EXT_LIV_var <- var(d$HEX_EXT_LIV_M, na.rm = T)
HEX_EXT_SOC_var <- var(d$HEX_EXT_SOC_M, na.rm = T)
HEX_EXT_SSE_var <- var(d$HEX_EXT_SSE_M, na.rm = T)
HEX_HOH_FAI_var <- var(d$HEX_HOH_FAI_M, na.rm = T)
HEX_HOH_GRE_var <- var(d$HEX_HOH_GRE_M, na.rm = T)
HEX_HOH_MOD_var <- var(d$HEX_HOH_MOD_M, na.rm = T)
HEX_HOH_SIN_var <- var(d$HEX_HOH_SIN_M, na.rm = T)
HEX_OPN_AES_var <- var(d$HEX_OPN_AES_M, na.rm = T)
HEX_OPN_CRE_var <- var(d$HEX_OPN_CRE_M, na.rm = T)
HEX_OPN_INQ_var <- var(d$HEX_OPN_INQ_M, na.rm = T)
HEX_OPN_UNC_var <- var(d$HEX_OPN_UNC_M, na.rm = T)

NFP_ANO_var <- var(d$NFP_ANO_M, na.rm = T)
NFP_COM_var <- var(d$NFP_COM_M, na.rm = T)
NFP_GEN_var <- var(d$NFP_GEN_M, na.rm = T)
NFP_GOV_var <- var(d$NFP_GOV_M, na.rm = T)
NFP_INF_var <- var(d$NFP_INF_M, na.rm = T)
NFP_PHY_var <- var(d$NFP_PHY_M, na.rm = T)
NFP_PSY_var <- var(d$NFP_PSY_M, na.rm = T)
NFP_SOC_var <- var(d$NFP_SOC_M, na.rm = T)

HEX_AGR_var <- var(d$HEX_AGR_M, na.rm = T)
HEX_CNS_var <- var(d$HEX_CNS_M, na.rm = T)
HEX_EMO_var <- var(d$HEX_EMO_M, na.rm = T)
HEX_EXT_var <- var(d$HEX_EXT_M, na.rm = T)
HEX_HOH_var <- var(d$HEX_HOH_M, na.rm = T)
HEX_OPN_var <- var(d$HEX_OPN_M, na.rm = T)

# Get reliability
c_rel <- 
  c(
    HEX_ALT_rel     = reliability(fit_HEX_ALT)["omega", "HEX_ALT"],
    HEX_AGR_FLX_rel = reliability(fit_HEX_AGR_FLX)["omega", "HEX_AGR_FLX"],
    HEX_AGR_FOR_rel = reliability(fit_HEX_AGR_FOR)["omega", "HEX_AGR_FOR"],
    HEX_AGR_GEN_rel = reliability(fit_HEX_AGR_GEN)["omega", "HEX_AGR_GEN"],
    HEX_AGR_PAT_rel = reliability(fit_HEX_AGR_PAT)["omega", "HEX_AGR_PAT"],
    HEX_CNS_DIL_rel = reliability(fit_HEX_CNS_DIL)["omega", "HEX_CNS_DIL"],
    HEX_CNS_ORG_rel = reliability(fit_HEX_CNS_ORG)["omega", "HEX_CNS_ORG"],
    HEX_CNS_PER_rel = reliability(fit_HEX_CNS_PER)["omega", "HEX_CNS_PER"],
    HEX_CNS_PRU_rel = reliability(fit_HEX_CNS_PRU)["omega", "HEX_CNS_PRU"],
    HEX_EMO_ANX_rel = reliability(fit_HEX_EMO_ANX)["omega", "HEX_EMO_ANX"],
    HEX_EMO_DEP_rel = reliability(fit_HEX_EMO_DEP)["omega", "HEX_EMO_DEP"],
    HEX_EMO_FEA_rel = reliability(fit_HEX_EMO_FEA)["omega", "HEX_EMO_FEA"],
    HEX_EMO_SEN_rel = reliability(fit_HEX_EMO_SEN)["omega", "HEX_EMO_SEN"],
    HEX_EXT_BOL_rel = reliability(fit_HEX_EXT_BOL)["omega", "HEX_EXT_BOL"],
    HEX_EXT_LIV_rel = reliability(fit_HEX_EXT_LIV)["omega", "HEX_EXT_LIV"],
    HEX_EXT_SOC_rel = reliability(fit_HEX_EXT_SOC)["omega", "HEX_EXT_SOC"],
    HEX_EXT_SSE_rel = reliability(fit_HEX_EXT_SSE)["omega", "HEX_EXT_SSE"],
    HEX_HOH_FAI_rel = reliability(fit_HEX_HOH_FAI)["omega", "HEX_HOH_FAI"],
    HEX_HOH_GRE_rel = reliability(fit_HEX_HOH_GRE)["omega", "HEX_HOH_GRE"],
    HEX_HOH_MOD_rel = reliability(fit_HEX_HOH_MOD)["omega", "HEX_HOH_MOD"],
    HEX_HOH_SIN_rel = reliability(fit_HEX_HOH_SIN)["omega", "HEX_HOH_SIN"],
    HEX_OPN_AES_rel = reliability(fit_HEX_OPN_AES)["omega", "HEX_OPN_AES"],
    HEX_OPN_CRE_rel = reliability(fit_HEX_OPN_CRE)["omega", "HEX_OPN_CRE"],
    HEX_OPN_INQ_rel = reliability(fit_HEX_OPN_INQ)["omega", "HEX_OPN_INQ"],
    HEX_OPN_UNC_rel = reliability(fit_HEX_OPN_UNC)["omega", "HEX_OPN_UNC"],
    
    NFP_ANO_rel     = reliability(fit_NFP_ANO)["omega", "NFP_ANO"],
    NFP_COM_rel     = reliability(fit_NFP_COM)["omega", "NFP_COM"],
    NFP_GEN_rel     = reliability(fit_NFP_GEN)["omega", "NFP_GEN"],
    NFP_GOV_rel     = reliability(fit_NFP_GOV)["omega", "NFP_GOV"],
    NFP_INF_rel     = reliability(fit_NFP_INF)["omega", "NFP_INF"],
    NFP_PHY_rel     = reliability(fit_NFP_PHY)["omega", "NFP_PHY"],
    NFP_PSY_rel     = reliability(fit_NFP_PSY)["omega", "NFP_PSY"],
    NFP_SOC_rel     = reliability(fit_NFP_SOC)["omega", "NFP_SOC"],
    
    HEX_HOH_rel     = reliability(fit_hex_hoh, return.total = T)["omega", "total"],
    HEX_EMO_rel     = reliability(fit_hex_emo, return.total = T)["omega", "total"],
    HEX_EXT_rel     = reliability(fit_hex_ext, return.total = T)["omega", "total"],
    HEX_AGR_rel     = reliability(fit_hex_agr, return.total = T)["omega", "total"],
    HEX_CNS_rel     = reliability(fit_hex_cns, return.total = T)["omega", "total"],
    HEX_OPN_rel     = reliability(fit_hex_opn, return.total = T)["omega", "total"]
  )

# Define error
HEX_ALT_err     <- (1 - c_rel["HEX_ALT_rel"]) * HEX_ALT_var
HEX_AGR_FLX_err <- (1 - c_rel["HEX_AGR_FLX_rel"]) * HEX_AGR_FLX_var
HEX_AGR_FOR_err <- (1 - c_rel["HEX_AGR_FOR_rel"]) * HEX_AGR_FOR_var
HEX_AGR_GEN_err <- (1 - c_rel["HEX_AGR_GEN_rel"]) * HEX_AGR_GEN_var
HEX_AGR_PAT_err <- (1 - c_rel["HEX_AGR_PAT_rel"]) * HEX_AGR_PAT_var
HEX_CNS_DIL_err <- (1 - c_rel["HEX_CNS_DIL_rel"]) * HEX_CNS_DIL_var
HEX_CNS_ORG_err <- (1 - c_rel["HEX_CNS_ORG_rel"]) * HEX_CNS_ORG_var
HEX_CNS_PER_err <- (1 - c_rel["HEX_CNS_PER_rel"]) * HEX_CNS_PER_var
HEX_CNS_PRU_err <- (1 - c_rel["HEX_CNS_PRU_rel"]) * HEX_CNS_PRU_var
HEX_EMO_ANX_err <- (1 - c_rel["HEX_EMO_ANX_rel"]) * HEX_EMO_ANX_var
HEX_EMO_DEP_err <- (1 - c_rel["HEX_EMO_DEP_rel"]) * HEX_EMO_DEP_var
HEX_EMO_FEA_err <- (1 - c_rel["HEX_EMO_FEA_rel"]) * HEX_EMO_FEA_var
HEX_EMO_SEN_err <- (1 - c_rel["HEX_EMO_SEN_rel"]) * HEX_EMO_SEN_var
HEX_EXT_BOL_err <- (1 - c_rel["HEX_EXT_BOL_rel"]) * HEX_EXT_BOL_var
HEX_EXT_LIV_err <- (1 - c_rel["HEX_EXT_LIV_rel"]) * HEX_EXT_LIV_var
HEX_EXT_SOC_err <- (1 - c_rel["HEX_EXT_SOC_rel"]) * HEX_EXT_SOC_var
HEX_EXT_SSE_err <- (1 - c_rel["HEX_EXT_SSE_rel"]) * HEX_EXT_SSE_var
HEX_HOH_FAI_err <- (1 - c_rel["HEX_HOH_FAI_rel"]) * HEX_HOH_FAI_var
HEX_HOH_GRE_err <- (1 - c_rel["HEX_HOH_GRE_rel"]) * HEX_HOH_GRE_var
HEX_HOH_MOD_err <- (1 - c_rel["HEX_HOH_MOD_rel"]) * HEX_HOH_MOD_var
HEX_HOH_SIN_err <- (1 - c_rel["HEX_HOH_SIN_rel"]) * HEX_HOH_SIN_var
HEX_OPN_AES_err <- (1 - c_rel["HEX_OPN_AES_rel"]) * HEX_OPN_AES_var
HEX_OPN_CRE_err <- (1 - c_rel["HEX_OPN_CRE_rel"]) * HEX_OPN_CRE_var
HEX_OPN_INQ_err <- (1 - c_rel["HEX_OPN_INQ_rel"]) * HEX_OPN_INQ_var
HEX_OPN_UNC_err <- (1 - c_rel["HEX_OPN_UNC_rel"]) * HEX_OPN_UNC_var

NFP_ANO_err     <- (1 - c_rel["NFP_ANO_rel"]) * NFP_ANO_var
NFP_COM_err     <- (1 - c_rel["NFP_COM_rel"]) * NFP_COM_var
NFP_GEN_err     <- (1 - c_rel["NFP_GEN_rel"]) * NFP_GEN_var
NFP_GOV_err     <- (1 - c_rel["NFP_GOV_rel"]) * NFP_GOV_var
NFP_INF_err     <- (1 - c_rel["NFP_INF_rel"]) * NFP_INF_var
NFP_PHY_err     <- (1 - c_rel["NFP_PHY_rel"]) * NFP_PHY_var
NFP_PSY_err     <- (1 - c_rel["NFP_PSY_rel"]) * NFP_PSY_var
NFP_SOC_err     <- (1 - c_rel["NFP_SOC_rel"]) * NFP_SOC_var

HEX_AGR_err <- (1 - c_rel["HEX_AGR_rel"]) * HEX_AGR_var
HEX_CNS_err <- (1 - c_rel["HEX_CNS_rel"]) * HEX_CNS_var
HEX_EMO_err <- (1 - c_rel["HEX_EMO_rel"]) * HEX_EMO_var
HEX_EXT_err <- (1 - c_rel["HEX_EXT_rel"]) * HEX_EXT_var
HEX_HOH_err <- (1 - c_rel["HEX_HOH_rel"]) * HEX_HOH_var
HEX_OPN_err <- (1 - c_rel["HEX_OPN_rel"]) * HEX_OPN_var

HEX_err <- data.frame(
  err = 
    c(HEX_HOH_err, 
      HEX_EMO_err, 
      HEX_EXT_err, 
      HEX_AGR_err, 
      HEX_CNS_err,
      HEX_OPN_err
      )
  ) %>% 
  round(3)

NFP_err <- data.frame(
  err = 
    c(NFP_PSY_err, 
      NFP_SOC_err, 
      NFP_PHY_err, 
      NFP_GOV_err, 
      NFP_COM_err,
      NFP_INF_err,
      NFP_ANO_err,
      NFP_GEN_err
      )
  ) %>% 
  round(3)

HEX_NFP_err <- rbind(HEX_err, NFP_err)
```

# Results
## Dimensions

Let's look at relations between need for privacy and personality dimensions.

We first do so in an SEM using latent factors.

```{r results-dims, warning=T}
model_dim <- "
# Personality Factors
HEX_HOH =~ HEX_HOH_SIN + HEX_HOH_FAI + HEX_HOH_GRE + HEX_HOH_MOD
HEX_HOH_SIN =~ HEX_HOH_SIN_01 + HEX_HOH_SIN_02 + HEX_HOH_SIN_03 + HEX_HOH_SIN_04
HEX_HOH_FAI =~ HEX_HOH_FAI_01 + HEX_HOH_FAI_02 + HEX_HOH_FAI_03 + HEX_HOH_FAI_04
HEX_HOH_GRE =~ HEX_HOH_GRE_01 + HEX_HOH_GRE_02 + HEX_HOH_GRE_03 + HEX_HOH_GRE_04
HEX_HOH_MOD =~ HEX_HOH_MOD_01 + HEX_HOH_MOD_02 + HEX_HOH_MOD_03 + HEX_HOH_MOD_04

HEX_EMO =~ HEX_EMO_FEA + HEX_EMO_ANX + HEX_EMO_DEP + HEX_EMO_SEN
HEX_EMO_FEA =~ HEX_EMO_FEA_01 + HEX_EMO_FEA_02 + HEX_EMO_FEA_03 + HEX_EMO_FEA_04
HEX_EMO_ANX =~ HEX_EMO_ANX_01 + HEX_EMO_ANX_02 + HEX_EMO_ANX_03 + HEX_EMO_ANX_04 + HEX_EMO_FEA_04
HEX_EMO_DEP =~ HEX_EMO_DEP_01 + HEX_EMO_DEP_02 + HEX_EMO_DEP_03 + HEX_EMO_DEP_04
HEX_EMO_SEN =~ HEX_EMO_SEN_01 + HEX_EMO_SEN_02 + HEX_EMO_SEN_03 + HEX_EMO_SEN_04

HEX_EXT =~ HEX_EXT_SSE + HEX_EXT_BOL + HEX_EXT_SOC + HEX_EXT_LIV
HEX_EXT_SSE =~ HEX_EXT_SSE_01 + HEX_EXT_SSE_02 + HEX_EXT_SSE_03 + HEX_EXT_SSE_04
HEX_EXT_BOL =~ HEX_EXT_BOL_01 + HEX_EXT_BOL_02 + HEX_EXT_BOL_03 + HEX_EXT_BOL_04
HEX_EXT_SOC =~ HEX_EXT_SOC_01 + HEX_EXT_SOC_02 + HEX_EXT_SOC_03 + HEX_EXT_SOC_04 + HEX_EXT_BOL_02
HEX_EXT_LIV =~ HEX_EXT_LIV_01 + HEX_EXT_LIV_02 + HEX_EXT_LIV_03 + HEX_EXT_LIV_04

HEX_AGR =~ HEX_AGR_FOR + HEX_AGR_GEN + HEX_AGR_FLX + HEX_AGR_PAT
HEX_AGR_FOR =~ HEX_AGR_FOR_01 + HEX_AGR_FOR_02 + HEX_AGR_FOR_03 + HEX_AGR_FOR_04 + HEX_AGR_PAT_02
HEX_AGR_GEN =~ HEX_AGR_GEN_01 + HEX_AGR_GEN_02 + HEX_AGR_GEN_03 + HEX_AGR_GEN_04
HEX_AGR_FLX =~ HEX_AGR_FLX_01 + HEX_AGR_FLX_02 + HEX_AGR_FLX_03 + HEX_AGR_FLX_04
HEX_AGR_PAT =~ HEX_AGR_PAT_01 + HEX_AGR_PAT_02 + HEX_AGR_PAT_03 + HEX_AGR_PAT_04

HEX_CNS =~ HEX_CNS_ORG + HEX_CNS_DIL + HEX_CNS_PER + HEX_CNS_PRU
HEX_CNS_ORG =~ HEX_CNS_ORG_01 + HEX_CNS_ORG_02 + HEX_CNS_ORG_03 + HEX_CNS_ORG_04
HEX_CNS_DIL =~ HEX_CNS_DIL_01 + HEX_CNS_DIL_02 + HEX_CNS_DIL_03 + HEX_CNS_DIL_04
HEX_CNS_PER =~ HEX_CNS_PER_01 + HEX_CNS_PER_02 + HEX_CNS_PER_03 + HEX_CNS_PER_04
HEX_CNS_PRU =~ HEX_CNS_PRU_01 + HEX_CNS_PRU_02 + HEX_CNS_PRU_03 + HEX_CNS_PRU_04

HEX_OPN =~ HEX_OPN_AES + HEX_OPN_INQ + HEX_OPN_CRE + HEX_OPN_UNC
HEX_OPN_AES =~ HEX_OPN_AES_01 + HEX_OPN_AES_02 + HEX_OPN_AES_03 + HEX_OPN_AES_04
HEX_OPN_INQ =~ HEX_OPN_INQ_01 + HEX_OPN_INQ_02 + HEX_OPN_INQ_03 + HEX_OPN_INQ_04
HEX_OPN_CRE =~ HEX_OPN_CRE_01 + HEX_OPN_CRE_02 + HEX_OPN_CRE_03 + HEX_OPN_CRE_04
HEX_OPN_UNC =~ HEX_OPN_UNC_01 + HEX_OPN_UNC_02 + HEX_OPN_UNC_03 + HEX_OPN_UNC_04

# Privacy
NFP_PHY =~ NFP_PHY_01 + NFP_PHY_02 + NFP_PHY_03 + NFP_PHY_04 + NFP_GEN_01
NFP_PSY =~ NFP_PSY_01 + NFP_PSY_02 + NFP_PSY_03 + NFP_PSY_04 + NFP_GEN_01 + NFP_INF_01
NFP_SOC =~ NFP_SOC_01 + NFP_SOC_02 + NFP_SOC_03 + NFP_SOC_04 + NFP_GEN_01 + NFP_INF_01
NFP_COM =~ NFP_COM_01 + NFP_COM_02 + NFP_COM_03 + NFP_COM_04
NFP_GOV =~ NFP_GOV_01 + NFP_GOV_02 + NFP_GOV_03 + NFP_GOV_04
NFP_ANO =~ NFP_ANO_01 + NFP_ANO_02 + NFP_ANO_03 + NFP_ANO_04
NFP_INF =~ NFP_INF_01 + NFP_INF_02 + NFP_INF_03 + NFP_INF_04
NFP_GEN =~ NFP_GEN_01 + NFP_GEN_02 + NFP_GEN_03 + NFP_GEN_04

# Covariances
HEX_HOH_SIN_01 ~~ HEX_HOH_SIN_03
HEX_HOH_SIN_02 ~~ HEX_HOH_SIN_04
HEX_HOH_GRE_01 ~~ HEX_HOH_GRE_02
HEX_HOH_GRE_03 ~~ HEX_HOH_GRE_04
HEX_EMO_DEP_01 ~~ HEX_EMO_DEP_04
HEX_EMO_DEP_02 ~~ HEX_EMO_DEP_03
HEX_EMO_SEN_01 ~~ HEX_EMO_SEN_03
HEX_EMO_SEN_02 ~~ HEX_EMO_SEN_04
HEX_EXT_SSE_01 ~~ HEX_EXT_SSE_04
HEX_EXT_SSE_02 ~~ HEX_EXT_SSE_03
HEX_EXT_BOL_01 ~~ HEX_EXT_BOL_04
HEX_EXT_BOL_02 ~~ HEX_EXT_BOL_03
HEX_EXT_LIV_01 ~~ HEX_EXT_LIV_03
HEX_EXT_LIV_02 ~~ HEX_EXT_LIV_04
HEX_AGR_PAT_01 ~~ HEX_AGR_PAT_02
HEX_AGR_PAT_03 ~~ HEX_AGR_PAT_04
HEX_CNS_ORG_01 ~~ HEX_CNS_ORG_04
HEX_CNS_ORG_02 ~~ HEX_CNS_ORG_03
HEX_CNS_DIL_01 ~~ HEX_CNS_DIL_02
HEX_CNS_DIL_03 ~~ HEX_CNS_DIL_04
HEX_CNS_PER_01 ~~ HEX_CNS_PER_04
HEX_CNS_PER_02 ~~ HEX_CNS_PER_03
HEX_CNS_PRU_01 ~~ HEX_CNS_PRU_04
HEX_CNS_PRU_02 ~~ HEX_CNS_PRU_03
HEX_OPN_INQ_01 ~~ HEX_OPN_INQ_04
HEX_OPN_INQ_02 ~~ HEX_OPN_INQ_03
HEX_OPN_UNC_01 ~~ HEX_OPN_UNC_04
HEX_OPN_UNC_02 ~~ HEX_OPN_UNC_03
HEX_ALT_01 ~~ HEX_ALT_02
HEX_ALT_03 ~~ HEX_ALT_04
HEX_AGR_GEN_01	~~	HEX_AGR_FLX_01

NFP_SOC_01 ~~ NFP_SOC_03
NFP_SOC_02 ~~ NFP_SOC_04
NFP_GOV_01 ~~ NFP_GOV_03
NFP_GOV_02 ~~ NFP_GOV_04
NFP_INF_01 ~~ NFP_INF_04
NFP_INF_02 ~~ NFP_INF_03
NFP_ANO_01 ~~ NFP_ANO_04
NFP_ANO_02 ~~ NFP_ANO_03
"
fit_dim <- sem(model_dim, d, estimator = "ML", fixed.x = TRUE)
summary(fit_dim, standardized = TRUE, fit = TRUE)

# get standardized data
d_dim <- 
  standardizedsolution(fit_dim)
```

Throws two warnings (covariance matrix of latent variables and residuals is not positive definite). Fit is also poor. Hence let's use means of observed values for personality and for privacy. Let's specify errors as preregistered.

```{r warning=T}
model_dim_err <- "
# Personality Factors
HEX_HOH =~ HEX_HOH_M
HEX_EMO =~ HEX_EMO_M
HEX_EXT =~ HEX_EXT_M
HEX_AGR =~ HEX_AGR_M
HEX_CNS =~ HEX_CNS_M
HEX_OPN =~ HEX_OPN_M

# Privacy
NFP_PHY =~ NFP_PHY_M
NFP_PSY =~ NFP_PSY_M
NFP_SOC =~ NFP_SOC_M
NFP_GOV =~ NFP_GOV_M
NFP_COM =~ NFP_COM_M
NFP_INF =~ NFP_INF_M
NFP_ANO =~ NFP_ANO_M
NFP_GEN =~ NFP_GEN_M

# Define Error
HEX_HOH_M ~~ 0.104 * HEX_HOH_M
HEX_EMO_M ~~ 0.087 * HEX_EMO_M
HEX_EXT_M ~~ 0.099 * HEX_EXT_M
HEX_AGR_M ~~ 0.079 * HEX_AGR_M
HEX_CNS_M ~~ 0.085 * HEX_CNS_M
HEX_OPN_M ~~ 0.108 * HEX_OPN_M
NFP_PHY_M ~~ 0.353 * NFP_PHY_M
NFP_PSY_M ~~ 0.457 * NFP_PSY_M
NFP_SOC_M ~~ 0.328 * NFP_SOC_M
NFP_GOV_M ~~ 0.261 * NFP_GOV_M
NFP_COM_M ~~ 0.331 * NFP_COM_M
NFP_INF_M ~~ 0.284 * NFP_INF_M
NFP_ANO_M ~~ 0.603 * NFP_ANO_M
NFP_GEN_M ~~ 0.207 * NFP_GEN_M
"
fit_dim_err <- sem(model_dim_err, d, estimator = "ML", fixed.x = TRUE)
summary(fit_dim_err, standardized = TRUE, fit = TRUE)
```

Similarly, throws a warning: "covariance matrix of latent variables is not positive definite." Let's hence look at correlations of observed mean scores. Also do in subsequent analyses (i.e., facets and SES), to maintain comparability.

```{r}
# make table
tab_cor_dim_m <- 
  d %>% 
  select(
    paste0(vars_pers_dim, "_M"),
    paste0(vars_pri, "_M")
    ) %>% 
  cor(use = "pairwise") %>% 
  round(2) %>% 
  as.data.frame() %>% 
  select(starts_with("NFP")) %>% 
  head(6) %>% 
  cbind(
    `Personality dimension` = factor(
      vars_pers_dim, 
      levels = vars_pers_dim, 
      labels = vars_pers_dim_txt
      ),
    .
    ) %>% 
  remove_rownames() %>% 
  set_names(c("Personality factors", vars_pri_txt_abr))

tab_cor_dim_m
```

## Facets

Let's first look at latent model to confirm it's also not converging.

```{r results-facets, eval=T, warning=T}
model_fac <- "

# Personality
HEX_HOH_SIN =~ HEX_HOH_SIN_01 + HEX_HOH_SIN_02 + HEX_HOH_SIN_03 + HEX_HOH_SIN_04
HEX_HOH_FAI =~ HEX_HOH_FAI_01 + HEX_HOH_FAI_02 + HEX_HOH_FAI_03 + HEX_HOH_FAI_04
HEX_HOH_GRE =~ HEX_HOH_GRE_01 + HEX_HOH_GRE_02 + HEX_HOH_GRE_03 + HEX_HOH_GRE_04
HEX_HOH_MOD =~ HEX_HOH_MOD_01 + HEX_HOH_MOD_02 + HEX_HOH_MOD_03 + HEX_HOH_MOD_04
HEX_EMO_FEA =~ HEX_EMO_FEA_01 + HEX_EMO_FEA_02 + HEX_EMO_FEA_03 + HEX_EMO_FEA_04
HEX_EMO_ANX =~ HEX_EMO_ANX_01 + HEX_EMO_ANX_02 + HEX_EMO_ANX_03 + HEX_EMO_ANX_04 + HEX_EMO_FEA_04
HEX_EMO_DEP =~ HEX_EMO_DEP_01 + HEX_EMO_DEP_02 + HEX_EMO_DEP_03 + HEX_EMO_DEP_04
HEX_EMO_SEN =~ HEX_EMO_SEN_01 + HEX_EMO_SEN_02 + HEX_EMO_SEN_03 + HEX_EMO_SEN_04
HEX_EXT_SSE =~ HEX_EXT_SSE_01 + HEX_EXT_SSE_02 + HEX_EXT_SSE_03 + HEX_EXT_SSE_04
HEX_EXT_BOL =~ HEX_EXT_BOL_01 + HEX_EXT_BOL_02 + HEX_EXT_BOL_03 + HEX_EXT_BOL_04
HEX_EXT_SOC =~ HEX_EXT_SOC_01 + HEX_EXT_SOC_02 + HEX_EXT_SOC_03 + HEX_EXT_SOC_04 + HEX_EXT_BOL_02
HEX_EXT_LIV =~ HEX_EXT_LIV_01 + HEX_EXT_LIV_02 + HEX_EXT_LIV_03 + HEX_EXT_LIV_04
HEX_AGR_FOR =~ HEX_AGR_FOR_01 + HEX_AGR_FOR_02 + HEX_AGR_FOR_03 + HEX_AGR_FOR_04 + HEX_AGR_PAT_02
HEX_AGR_GEN =~ HEX_AGR_GEN_01 + HEX_AGR_GEN_02 + HEX_AGR_GEN_03 + HEX_AGR_GEN_04
HEX_AGR_FLX =~ HEX_AGR_FLX_01 + HEX_AGR_FLX_02 + HEX_AGR_FLX_03 + HEX_AGR_FLX_04
HEX_AGR_PAT =~ HEX_AGR_PAT_01 + HEX_AGR_PAT_02 + HEX_AGR_PAT_03 + HEX_AGR_PAT_04
HEX_CNS_ORG =~ HEX_CNS_ORG_01 + HEX_CNS_ORG_02 + HEX_CNS_ORG_03 + HEX_CNS_ORG_04
HEX_CNS_DIL =~ HEX_CNS_DIL_01 + HEX_CNS_DIL_02 + HEX_CNS_DIL_03 + HEX_CNS_DIL_04
HEX_CNS_PER =~ HEX_CNS_PER_01 + HEX_CNS_PER_02 + HEX_CNS_PER_03 + HEX_CNS_PER_04
HEX_CNS_PRU =~ HEX_CNS_PRU_01 + HEX_CNS_PRU_02 + HEX_CNS_PRU_03 + HEX_CNS_PRU_04
HEX_OPN_AES =~ HEX_OPN_AES_01 + HEX_OPN_AES_02 + HEX_OPN_AES_03 + HEX_OPN_AES_04
HEX_OPN_INQ =~ HEX_OPN_INQ_01 + HEX_OPN_INQ_02 + HEX_OPN_INQ_03 + HEX_OPN_INQ_04
HEX_OPN_CRE =~ HEX_OPN_CRE_01 + HEX_OPN_CRE_02 + HEX_OPN_CRE_03 + HEX_OPN_CRE_04
HEX_OPN_UNC =~ HEX_OPN_UNC_01 + HEX_OPN_UNC_02 + HEX_OPN_UNC_03 + HEX_OPN_UNC_04
HEX_ALT =~ HEX_ALT_01 + HEX_ALT_02 + HEX_ALT_03 + HEX_ALT_04

# Privacy
NFP_PHY =~ NFP_PHY_01 + NFP_PHY_02 + NFP_PHY_03 + NFP_PHY_04 + NFP_GEN_01
NFP_PSY =~ NFP_PSY_01 + NFP_PSY_02 + NFP_PSY_03 + NFP_PSY_04 + NFP_GEN_01 + NFP_INF_01
NFP_SOC =~ NFP_SOC_01 + NFP_SOC_02 + NFP_SOC_03 + NFP_SOC_04 + NFP_GEN_01 + NFP_INF_01
NFP_COM =~ NFP_COM_01 + NFP_COM_02 + NFP_COM_03 + NFP_COM_04
NFP_GOV =~ NFP_GOV_01 + NFP_GOV_02 + NFP_GOV_03 + NFP_GOV_04
NFP_ANO =~ NFP_ANO_01 + NFP_ANO_02 + NFP_ANO_03 + NFP_ANO_04
NFP_INF =~ NFP_INF_01 + NFP_INF_02 + NFP_INF_03 + NFP_INF_04
NFP_GEN =~ NFP_GEN_01 + NFP_GEN_02 + NFP_GEN_03 + NFP_GEN_04

# Covariances
HEX_HOH_SIN_01 ~~ HEX_HOH_SIN_03
HEX_HOH_SIN_02 ~~ HEX_HOH_SIN_04
HEX_HOH_GRE_01 ~~ HEX_HOH_GRE_02
HEX_HOH_GRE_03 ~~ HEX_HOH_GRE_04
HEX_EMO_DEP_01 ~~ HEX_EMO_DEP_04
HEX_EMO_DEP_02 ~~ HEX_EMO_DEP_03
HEX_EMO_SEN_01 ~~ HEX_EMO_SEN_03
HEX_EMO_SEN_02 ~~ HEX_EMO_SEN_04
HEX_EXT_SSE_01 ~~ HEX_EXT_SSE_04
HEX_EXT_SSE_02 ~~ HEX_EXT_SSE_03
HEX_EXT_BOL_01 ~~ HEX_EXT_BOL_04
HEX_EXT_BOL_02 ~~ HEX_EXT_BOL_03
HEX_EXT_LIV_01 ~~ HEX_EXT_LIV_03
HEX_EXT_LIV_02 ~~ HEX_EXT_LIV_04
HEX_AGR_PAT_01 ~~ HEX_AGR_PAT_02
HEX_AGR_PAT_03 ~~ HEX_AGR_PAT_04
HEX_CNS_ORG_01 ~~ HEX_CNS_ORG_04
HEX_CNS_ORG_02 ~~ HEX_CNS_ORG_03
HEX_CNS_DIL_01 ~~ HEX_CNS_DIL_02
HEX_CNS_DIL_03 ~~ HEX_CNS_DIL_04
HEX_CNS_PER_01 ~~ HEX_CNS_PER_04
HEX_CNS_PER_02 ~~ HEX_CNS_PER_03
HEX_CNS_PRU_01 ~~ HEX_CNS_PRU_04
HEX_CNS_PRU_02 ~~ HEX_CNS_PRU_03
HEX_OPN_INQ_01 ~~ HEX_OPN_INQ_04
HEX_OPN_INQ_02 ~~ HEX_OPN_INQ_03
HEX_OPN_UNC_01 ~~ HEX_OPN_UNC_04
HEX_OPN_UNC_02 ~~ HEX_OPN_UNC_03
HEX_AGR_GEN_01	~~	HEX_AGR_FLX_01

HEX_ALT_01 ~~ HEX_ALT_02
HEX_ALT_03 ~~ HEX_ALT_04
NFP_SOC_01 ~~ NFP_SOC_03
NFP_SOC_02 ~~ NFP_SOC_04
NFP_GOV_01 ~~ NFP_GOV_03
NFP_GOV_02 ~~ NFP_GOV_04
NFP_INF_01 ~~ NFP_INF_04
NFP_INF_02 ~~ NFP_INF_03
NFP_ANO_01 ~~ NFP_ANO_04
NFP_ANO_02 ~~ NFP_ANO_03
"
fit_fac <- sem(model_fac, d, estimator = "ML", fixed.x = TRUE)
summary(fit_fac, standardized = TRUE, fit = TRUE)

# get standardized data
d_fac <- 
  standardizedsolution(fit_fac)
```

As expected, throws the same warning. Let's hence again use correlations of observed mean values.

```{r}
tab_cor_fac_m <- 
  d %>% 
  select(
    paste0(vars_pers_fac, "_M"),
    paste0(vars_pri, "_M")
    ) %>% 
  cor(use = "pairwise") %>% 
  round(2) %>% 
  as.data.frame() %>% 
  select(starts_with("NFP")) %>% 
  head(25) %>% 
  relocate(paste0(vars_pri, "_M")) %>% 
  rownames_to_column("Facets") %>% 
  mutate(
    Facets = factor(
      x = Facets,
      levels = paste0(vars_pers_fac, "_M"),
      labels = vars_pers_fac_txt
    )
      ) %>% 
  arrange(Facets) %>% 
  set_names(c("Personality factors", vars_pri_txt_abr))
tab_cor_fac_m
```

## SES

Let's directly inspect results of correlations between means of observed scores.

```{r warning=T}
# make table
tab_cor_ses_m <- 
  d %>% 
  select(
    all_of(
      vars_ses
      ),
    all_of(
     paste0(vars_pri, "_M") 
    )
  ) %>%
  cor(use = "pairwise") %>% 
  round(2) %>% 
  as.data.frame() %>% 
  select(starts_with("NFP")) %>% 
  head(7) %>% 
  cbind(
    `Sociodemographics` = factor(
      vars_ses, 
      levels = vars_ses, 
      labels = vars_ses_txt
      ),
    .
    ) %>% 
  remove_rownames() %>% 
  set_names(c("Sociodemographics", vars_pri_txt_abr))
  
tab_cor_ses_m
```

## Regression

As preregistered, also look at multiple regression. Directly begin with means of observed values. Let's analyze in one single path-model.

Let's also look only at dimensions, as facets are strongly correlated with one another, leading to problems of multicollinearity.

```{r warning=T}
model_reg <- "
NFP_INF_M + NFP_PSY_M + NFP_PHY_M + NFP_SOC_M + NFP_GOV_M + NFP_COM_M + NFP_ANO_M + NFP_GEN_M ~ HEX_HOH_M + HEX_EMO_M + HEX_EXT_M + HEX_AGR_M + HEX_CNS_M + HEX_OPN_M + age + male + white + relation + college + income + conserv
"
fit_reg <- sem(model_reg, d, estimator = "ML", fixed.x = TRUE)
summary(fit_reg, standardized = TRUE, fit = TRUE)
```

# Tables
## Descriptives

Let's first make a descriptive table with means and model fit.

```{r cache=T}
# Extract model fit indices: CFI, TLI, RMSEA, SRMR
c_cfi <- 
  c(
    HEX_ALT_cfi     = fitmeasures(fit_HEX_ALT)["cfi.scaled"],
    HEX_AGR_FLX_cfi = fitmeasures(fit_HEX_AGR_FLX)["cfi.scaled"],
    HEX_AGR_FOR_cfi = fitmeasures(fit_HEX_AGR_FOR)["cfi.scaled"],
    HEX_AGR_GEN_cfi = fitmeasures(fit_HEX_AGR_GEN)["cfi.scaled"],
    HEX_AGR_PAT_cfi = fitmeasures(fit_HEX_AGR_PAT)["cfi.scaled"],
    HEX_CNS_DIL_cfi = fitmeasures(fit_HEX_CNS_DIL)["cfi.scaled"],
    HEX_CNS_ORG_cfi = fitmeasures(fit_HEX_CNS_ORG)["cfi.scaled"],
    HEX_CNS_PER_cfi = fitmeasures(fit_HEX_CNS_PER)["cfi.scaled"],
    HEX_CNS_PRU_cfi = fitmeasures(fit_HEX_CNS_PRU)["cfi.scaled"],
    HEX_EMO_ANX_cfi = fitmeasures(fit_HEX_EMO_ANX)["cfi.scaled"],
    HEX_EMO_DEP_cfi = fitmeasures(fit_HEX_EMO_DEP)["cfi.scaled"],
    HEX_EMO_FEA_cfi = fitmeasures(fit_HEX_EMO_FEA)["cfi.scaled"],
    HEX_EMO_SEN_cfi = fitmeasures(fit_HEX_EMO_SEN)["cfi.scaled"],
    HEX_EXT_BOL_cfi = fitmeasures(fit_HEX_EXT_BOL)["cfi.scaled"],
    HEX_EXT_LIV_cfi = fitmeasures(fit_HEX_EXT_LIV)["cfi.scaled"],
    HEX_EXT_SOC_cfi = fitmeasures(fit_HEX_EXT_SOC)["cfi.scaled"],
    HEX_EXT_SSE_cfi = fitmeasures(fit_HEX_EXT_SSE)["cfi.scaled"],
    HEX_HOH_FAI_cfi = fitmeasures(fit_HEX_HOH_FAI)["cfi.scaled"],
    HEX_HOH_GRE_cfi = fitmeasures(fit_HEX_HOH_GRE)["cfi.scaled"],
    HEX_HOH_MOD_cfi = fitmeasures(fit_HEX_HOH_MOD)["cfi.scaled"],
    HEX_HOH_SIN_cfi = fitmeasures(fit_HEX_HOH_SIN)["cfi.scaled"],
    HEX_OPN_AES_cfi = fitmeasures(fit_HEX_OPN_AES)["cfi.scaled"],
    HEX_OPN_CRE_cfi = fitmeasures(fit_HEX_OPN_CRE)["cfi.scaled"],
    HEX_OPN_INQ_cfi = fitmeasures(fit_HEX_OPN_INQ)["cfi.scaled"],
    HEX_OPN_UNC_cfi = fitmeasures(fit_HEX_OPN_UNC)["cfi.scaled"],
    NFP_ANO_cfi     = fitmeasures(fit_NFP_ANO)["cfi.scaled"],
    NFP_COM_cfi     = fitmeasures(fit_NFP_COM)["cfi.scaled"],
    NFP_GEN_cfi     = fitmeasures(fit_NFP_GEN)["cfi.scaled"],
    NFP_GOV_cfi     = fitmeasures(fit_NFP_GOV)["cfi.scaled"],
    NFP_INF_cfi     = fitmeasures(fit_NFP_INF)["cfi.scaled"],
    NFP_PHY_cfi     = fitmeasures(fit_NFP_PHY)["cfi.scaled"],
    NFP_PSY_cfi     = fitmeasures(fit_NFP_PSY)["cfi.scaled"],
    NFP_SOC_cfi     = fitmeasures(fit_NFP_SOC)["cfi.scaled"],
    HEX_HOH_srmr     = fitmeasures(fit_hex_hoh)["cfi.scaled"],
    HEX_EMO_srmr     = fitmeasures(fit_hex_emo)["cfi.scaled"],
    HEX_EXT_srmr     = fitmeasures(fit_hex_ext)["cfi.scaled"],
    HEX_AGR_srmr     = fitmeasures(fit_hex_agr)["cfi.scaled"],
    HEX_CNS_srmr     = fitmeasures(fit_hex_cns)["cfi.scaled"],
    HEX_OPN_srmr     = fitmeasures(fit_hex_opn)["cfi.scaled"]
  )

c_tli <- 
  c(
    HEX_ALT_tli     = fitmeasures(fit_HEX_ALT)["tli.scaled"],
    HEX_AGR_FLX_tli = fitmeasures(fit_HEX_AGR_FLX)["tli.scaled"],
    HEX_AGR_FOR_tli = fitmeasures(fit_HEX_AGR_FOR)["tli.scaled"],
    HEX_AGR_GEN_tli = fitmeasures(fit_HEX_AGR_GEN)["tli.scaled"],
    HEX_AGR_PAT_tli = fitmeasures(fit_HEX_AGR_PAT)["tli.scaled"],
    HEX_CNS_DIL_tli = fitmeasures(fit_HEX_CNS_DIL)["tli.scaled"],
    HEX_CNS_ORG_tli = fitmeasures(fit_HEX_CNS_ORG)["tli.scaled"],
    HEX_CNS_PER_tli = fitmeasures(fit_HEX_CNS_PER)["tli.scaled"],
    HEX_CNS_PRU_tli = fitmeasures(fit_HEX_CNS_PRU)["tli.scaled"],
    HEX_EMO_ANX_tli = fitmeasures(fit_HEX_EMO_ANX)["tli.scaled"],
    HEX_EMO_DEP_tli = fitmeasures(fit_HEX_EMO_DEP)["tli.scaled"],
    HEX_EMO_FEA_tli = fitmeasures(fit_HEX_EMO_FEA)["tli.scaled"],
    HEX_EMO_SEN_tli = fitmeasures(fit_HEX_EMO_SEN)["tli.scaled"],
    HEX_EXT_BOL_tli = fitmeasures(fit_HEX_EXT_BOL)["tli.scaled"],
    HEX_EXT_LIV_tli = fitmeasures(fit_HEX_EXT_LIV)["tli.scaled"],
    HEX_EXT_SOC_tli = fitmeasures(fit_HEX_EXT_SOC)["tli.scaled"],
    HEX_EXT_SSE_tli = fitmeasures(fit_HEX_EXT_SSE)["tli.scaled"],
    HEX_HOH_FAI_tli = fitmeasures(fit_HEX_HOH_FAI)["tli.scaled"],
    HEX_HOH_GRE_tli = fitmeasures(fit_HEX_HOH_GRE)["tli.scaled"],
    HEX_HOH_MOD_tli = fitmeasures(fit_HEX_HOH_MOD)["tli.scaled"],
    HEX_HOH_SIN_tli = fitmeasures(fit_HEX_HOH_SIN)["tli.scaled"],
    HEX_OPN_AES_tli = fitmeasures(fit_HEX_OPN_AES)["tli.scaled"],
    HEX_OPN_CRE_tli = fitmeasures(fit_HEX_OPN_CRE)["tli.scaled"],
    HEX_OPN_INQ_tli = fitmeasures(fit_HEX_OPN_INQ)["tli.scaled"],
    HEX_OPN_UNC_tli = fitmeasures(fit_HEX_OPN_UNC)["tli.scaled"],
    NFP_ANO_tli     = fitmeasures(fit_NFP_ANO)["tli.scaled"],
    NFP_COM_tli     = fitmeasures(fit_NFP_COM)["tli.scaled"],
    NFP_GEN_tli     = fitmeasures(fit_NFP_GEN)["tli.scaled"],
    NFP_GOV_tli     = fitmeasures(fit_NFP_GOV)["tli.scaled"],
    NFP_INF_tli     = fitmeasures(fit_NFP_INF)["tli.scaled"],
    NFP_PHY_tli     = fitmeasures(fit_NFP_PHY)["tli.scaled"],
    NFP_PSY_tli     = fitmeasures(fit_NFP_PSY)["tli.scaled"],
    NFP_SOC_tli     = fitmeasures(fit_NFP_SOC)["tli.scaled"],
    HEX_HOH_srmr     = fitmeasures(fit_hex_hoh)["tli.scaled"],
    HEX_EMO_srmr     = fitmeasures(fit_hex_emo)["tli.scaled"],
    HEX_EXT_srmr     = fitmeasures(fit_hex_ext)["tli.scaled"],
    HEX_AGR_srmr     = fitmeasures(fit_hex_agr)["tli.scaled"],
    HEX_CNS_srmr     = fitmeasures(fit_hex_cns)["tli.scaled"],
    HEX_OPN_srmr     = fitmeasures(fit_hex_opn)["tli.scaled"]
  )

c_rmsea <- 
  c(
    HEX_ALT_rmsea     = fitmeasures(fit_HEX_ALT)["rmsea.scaled"],
    HEX_AGR_FLX_rmsea = fitmeasures(fit_HEX_AGR_FLX)["rmsea.scaled"],
    HEX_AGR_FOR_rmsea = fitmeasures(fit_HEX_AGR_FOR)["rmsea.scaled"],
    HEX_AGR_GEN_rmsea = fitmeasures(fit_HEX_AGR_GEN)["rmsea.scaled"],
    HEX_AGR_PAT_rmsea = fitmeasures(fit_HEX_AGR_PAT)["rmsea.scaled"],
    HEX_CNS_DIL_rmsea = fitmeasures(fit_HEX_CNS_DIL)["rmsea.scaled"],
    HEX_CNS_ORG_rmsea = fitmeasures(fit_HEX_CNS_ORG)["rmsea.scaled"],
    HEX_CNS_PER_rmsea = fitmeasures(fit_HEX_CNS_PER)["rmsea.scaled"],
    HEX_CNS_PRU_rmsea = fitmeasures(fit_HEX_CNS_PRU)["rmsea.scaled"],
    HEX_EMO_ANX_rmsea = fitmeasures(fit_HEX_EMO_ANX)["rmsea.scaled"],
    HEX_EMO_DEP_rmsea = fitmeasures(fit_HEX_EMO_DEP)["rmsea.scaled"],
    HEX_EMO_FEA_rmsea = fitmeasures(fit_HEX_EMO_FEA)["rmsea.scaled"],
    HEX_EMO_SEN_rmsea = fitmeasures(fit_HEX_EMO_SEN)["rmsea.scaled"],
    HEX_EXT_BOL_rmsea = fitmeasures(fit_HEX_EXT_BOL)["rmsea.scaled"],
    HEX_EXT_LIV_rmsea = fitmeasures(fit_HEX_EXT_LIV)["rmsea.scaled"],
    HEX_EXT_SOC_rmsea = fitmeasures(fit_HEX_EXT_SOC)["rmsea.scaled"],
    HEX_EXT_SSE_rmsea = fitmeasures(fit_HEX_EXT_SSE)["rmsea.scaled"],
    HEX_HOH_FAI_rmsea = fitmeasures(fit_HEX_HOH_FAI)["rmsea.scaled"],
    HEX_HOH_GRE_rmsea = fitmeasures(fit_HEX_HOH_GRE)["rmsea.scaled"],
    HEX_HOH_MOD_rmsea = fitmeasures(fit_HEX_HOH_MOD)["rmsea.scaled"],
    HEX_HOH_SIN_rmsea = fitmeasures(fit_HEX_HOH_SIN)["rmsea.scaled"],
    HEX_OPN_AES_rmsea = fitmeasures(fit_HEX_OPN_AES)["rmsea.scaled"],
    HEX_OPN_CRE_rmsea = fitmeasures(fit_HEX_OPN_CRE)["rmsea.scaled"],
    HEX_OPN_INQ_rmsea = fitmeasures(fit_HEX_OPN_INQ)["rmsea.scaled"],
    HEX_OPN_UNC_rmsea = fitmeasures(fit_HEX_OPN_UNC)["rmsea.scaled"],
    NFP_ANO_rmsea     = fitmeasures(fit_NFP_ANO)["rmsea.scaled"],
    NFP_COM_rmsea     = fitmeasures(fit_NFP_COM)["rmsea.scaled"],
    NFP_GEN_rmsea     = fitmeasures(fit_NFP_GEN)["rmsea.scaled"],
    NFP_GOV_rmsea     = fitmeasures(fit_NFP_GOV)["rmsea.scaled"],
    NFP_INF_rmsea     = fitmeasures(fit_NFP_INF)["rmsea.scaled"],
    NFP_PHY_rmsea     = fitmeasures(fit_NFP_PHY)["rmsea.scaled"],
    NFP_PSY_rmsea     = fitmeasures(fit_NFP_PSY)["rmsea.scaled"],
    NFP_SOC_rmsea     = fitmeasures(fit_NFP_SOC)["rmsea.scaled"],
    HEX_HOH_srmr     = fitmeasures(fit_hex_hoh)["rmsea.scaled"],
    HEX_EMO_srmr     = fitmeasures(fit_hex_emo)["rmsea.scaled"],
    HEX_EXT_srmr     = fitmeasures(fit_hex_ext)["rmsea.scaled"],
    HEX_AGR_srmr     = fitmeasures(fit_hex_agr)["rmsea.scaled"],
    HEX_CNS_srmr     = fitmeasures(fit_hex_cns)["rmsea.scaled"],
    HEX_OPN_srmr     = fitmeasures(fit_hex_opn)["rmsea.scaled"]
  )

c_srmr <- 
  c(
    HEX_ALT_srmr     = fitmeasures(fit_HEX_ALT)["srmr"],
    HEX_AGR_FLX_srmr = fitmeasures(fit_HEX_AGR_FLX)["srmr"],
    HEX_AGR_FOR_srmr = fitmeasures(fit_HEX_AGR_FOR)["srmr"],
    HEX_AGR_GEN_srmr = fitmeasures(fit_HEX_AGR_GEN)["srmr"],
    HEX_AGR_PAT_srmr = fitmeasures(fit_HEX_AGR_PAT)["srmr"],
    HEX_CNS_DIL_srmr = fitmeasures(fit_HEX_CNS_DIL)["srmr"],
    HEX_CNS_ORG_srmr = fitmeasures(fit_HEX_CNS_ORG)["srmr"],
    HEX_CNS_PER_srmr = fitmeasures(fit_HEX_CNS_PER)["srmr"],
    HEX_CNS_PRU_srmr = fitmeasures(fit_HEX_CNS_PRU)["srmr"],
    HEX_EMO_ANX_srmr = fitmeasures(fit_HEX_EMO_ANX)["srmr"],
    HEX_EMO_DEP_srmr = fitmeasures(fit_HEX_EMO_DEP)["srmr"],
    HEX_EMO_FEA_srmr = fitmeasures(fit_HEX_EMO_FEA)["srmr"],
    HEX_EMO_SEN_srmr = fitmeasures(fit_HEX_EMO_SEN)["srmr"],
    HEX_EXT_BOL_srmr = fitmeasures(fit_HEX_EXT_BOL)["srmr"],
    HEX_EXT_LIV_srmr = fitmeasures(fit_HEX_EXT_LIV)["srmr"],
    HEX_EXT_SOC_srmr = fitmeasures(fit_HEX_EXT_SOC)["srmr"],
    HEX_EXT_SSE_srmr = fitmeasures(fit_HEX_EXT_SSE)["srmr"],
    HEX_HOH_FAI_srmr = fitmeasures(fit_HEX_HOH_FAI)["srmr"],
    HEX_HOH_GRE_srmr = fitmeasures(fit_HEX_HOH_GRE)["srmr"],
    HEX_HOH_MOD_srmr = fitmeasures(fit_HEX_HOH_MOD)["srmr"],
    HEX_HOH_SIN_srmr = fitmeasures(fit_HEX_HOH_SIN)["srmr"],
    HEX_OPN_AES_srmr = fitmeasures(fit_HEX_OPN_AES)["srmr"],
    HEX_OPN_CRE_srmr = fitmeasures(fit_HEX_OPN_CRE)["srmr"],
    HEX_OPN_INQ_srmr = fitmeasures(fit_HEX_OPN_INQ)["srmr"],
    HEX_OPN_UNC_srmr = fitmeasures(fit_HEX_OPN_UNC)["srmr"],
    NFP_ANO_srmr     = fitmeasures(fit_NFP_ANO)["srmr"],
    NFP_COM_srmr     = fitmeasures(fit_NFP_COM)["srmr"],
    NFP_GEN_srmr     = fitmeasures(fit_NFP_GEN)["srmr"],
    NFP_GOV_srmr     = fitmeasures(fit_NFP_GOV)["srmr"],
    NFP_INF_srmr     = fitmeasures(fit_NFP_INF)["srmr"],
    NFP_PHY_srmr     = fitmeasures(fit_NFP_PHY)["srmr"],
    NFP_PSY_srmr     = fitmeasures(fit_NFP_PSY)["srmr"],
    NFP_SOC_srmr     = fitmeasures(fit_NFP_SOC)["srmr"],
    HEX_HOH_srmr     = fitmeasures(fit_hex_hoh)["srmr"],
    HEX_EMO_srmr     = fitmeasures(fit_hex_emo)["srmr"],
    HEX_EXT_srmr     = fitmeasures(fit_hex_ext)["srmr"],
    HEX_AGR_srmr     = fitmeasures(fit_hex_agr)["srmr"],
    HEX_CNS_srmr     = fitmeasures(fit_hex_cns)["srmr"],
    HEX_OPN_srmr     = fitmeasures(fit_hex_opn)["srmr"]
  )

tab_des <- 
  data.frame(
    Variable = factor(
      gsub('.{2}$', '', names(c_m)), 
      levels = c(vars_pers_all, vars_pri),
      labels = c(vars_pers_all_txt, vars_pri_txt)),
    M = c_m,
    SD = c_sd,
    REL = c_rel,
    CFI = c_cfi,
    TLI = c_tli,
    SRMS = c_srmr,
    RMSEA = c_rmsea
  ) %>% 
  arrange(Variable) %>% 
  mutate(
    across(
      -Variable,
      ~ round(.x, 2)
    )
  ) %>% 
  remove_rownames()
tab_des
```

# Figures
## Correlation

```{r figcorr, cache=T, fig.height=9, fig.width=12, eval=T}
# First extract data
tab_cor <- 
  d %>% 
  correlation(
    select = 
      c(
        vars_ses, 
        paste0(
          c(vars_pers_dim, vars_pers_fac), 
        "_M"
        )
      ),
    select2 = paste0(vars_pri, "_M"),
    ci = .90) %>% 
  as.data.frame() %>% 
  mutate(
    across(
      c(r, CI_low, CI_high),
      ~ round(.x, 2)
    )
  ) %>% 
  rename(
    "Need for privacy" = Parameter2,
    "Predictor" = Parameter1,
    "Estimate" = r
  ) %>% 
  mutate(
    category = case_when(
      Predictor %in% vars_ses ~ "Sociodemographics",
      Predictor %in% paste0(vars_pers_hoh, "_M") ~ "Honesty humility",
      Predictor %in% paste0(vars_pers_emo, "_M") ~ "Emotionality", 
      Predictor %in% paste0(vars_pers_ext, "_M") ~ "Extraversion",
      Predictor %in% paste0(vars_pers_agr, "_M") ~ "Agreeableness", 
      Predictor %in% paste0(vars_pers_cns, "_M") ~ "Conscientiousness",
      Predictor %in% paste0(vars_pers_opn, "_M") ~ "Openness",
      .default = "missing"
    ),
    "Need for privacy" = factor(
      `Need for privacy`,
      levels = paste0(vars_pri, "_M"),
      labels = vars_pri_txt
    ),
    category = factor(
      category,
      levels = c(vars_pers_dim_txt, "Sociodemographics")
    ), 
    relevant = case_when(
      CI_low <= -.1 & CI_high <= -.1 | CI_low >= .1 & CI_high >= .1 ~ "yes",
      .default = "no"
    ),
    Predictor = factor(
      x = Predictor,
      levels = c(
        paste0(vars_pers_all, "_M"),
        vars_ses),
      labels = vars_pred_all_txt
    )
  ) %>% 
  select(
    -Method, -p, -df_error, -t, -CI
  )

fig_cor <- ggplot(
  tab_cor, aes(x = Estimate, y = Predictor, color = relevant)
  ) + 
  coord_cartesian(xlim = c(-.7, .3)) +
  geom_vline(xintercept = 0, lwd = .5, colour = "darkgrey") + 
  geom_vline(xintercept = -.1, lwd = .5, colour = "darkgrey", linetype = "dashed") + 
  geom_vline(xintercept = .1, lwd = .5, colour = "darkgrey", linetype = "dashed") + 
  geom_errorbarh(
    aes(xmin = CI_low, xmax = CI_high),
    lwd = .5, height = .4, position = position_dodge(-.7)
    ) +
  geom_point(size = 1, position = position_dodge(-.7)) +
#   geom_pointrange(aes(xmin = CI_low, xmax = CI_high), size = .2) + 
  scale_x_continuous(
    breaks = c(-.6, -.4, -.2, 0, .2, .4),
    labels = c("-.6", "-.4", "-.2", "0", ".2", ".4")
    ) + 
  scale_y_discrete(limits=rev) +
  labs(
    title = "Predicting the need for privacy",
    x = "Correlation coefficient"
    ) +
  # theme_minimal() +
  theme(
    axis.title.y = element_blank(),
    plot.title = element_text(hjust = .5),
    text = element_text(size = 14),
    axis.text.y = element_text(hjust = 1),
    axis.text.x = element_text(size = 10),
    legend.position = "none"
    ) + 
  scale_color_manual(values = c("grey", "black")) +
  facet_grid(category ~ `Need for privacy`, scales = "free_y")

suppressWarnings(print(fig_cor, warning = F))

ggsave("figures/fig_cor.png", width = 10, height = 12)
```

## Regression

```{r fig-reg, fig.height=6, fig.width=12}
tab_reg <- 
  standardizedsolution(fit_reg, ci = TRUE) %>% 
  as.data.frame() %>% 
  filter(
    op == "~", 
    lhs %in% paste0(vars_pri, "_M")
    ) %>% 
  select(
    "Need for privacy" = lhs, 
    "Predictor" = rhs, 
    Estimate = est.std, 
    CI_low = ci.lower, 
    CI_high = ci.upper
    ) %>% 
  mutate(
    Predictor = factor(
      Predictor, 
      levels = c(paste0(vars_pers_dim, "_M"), vars_ses), 
      labels = c(vars_pers_dim_txt, vars_ses_txt)
      ),
    `Need for privacy` = factor(
      `Need for privacy`, 
      levels = paste0(vars_pri, "_M"), 
      labels = c(vars_pri_txt)
      ),
    category = c(
      rep("Personality", 6),
      "Sociodemographics" %>% 
        rep(7)) %>% 
      rep(length(vars_pri_txt)),
    relevant = case_when(
      CI_low <= -.1 & CI_high <= -.1 | CI_low >= .1 & CI_high >= .1 ~ "yes",
      .default = "no"
      )
    )

fig_reg <- ggplot(
  tab_reg, aes(x = Estimate, y = Predictor, color = relevant)
  ) + 
  coord_cartesian(xlim = c(-.8, .3)) +
  geom_vline(xintercept = 0, lwd = .5, colour = "darkgrey") + 
  geom_vline(xintercept = -.1, lwd = .5, colour = "darkgrey", linetype = "dashed") + 
  geom_vline(xintercept = .1, lwd = .5, colour = "darkgrey", linetype = "dashed") + 
  geom_errorbarh(
    aes(xmin = CI_low, xmax = CI_high),
    lwd = .5, height = .4, position = position_dodge(-.7)
    ) +
  geom_point(size = 1, position = position_dodge(-.7)) +
  scale_x_continuous(
    breaks = c(-.8, -.6, -.4, -.2, 0, .2, .4),
    labels = c("-.8", "-.6", "-.4", "-.2", "0", ".2", ".4")
    ) + 
  scale_y_discrete(limits=rev) +
  scale_color_manual(values = c("grey", "black")) +
  labs(
    title = "Explaining the need for privacy",
    x = "Regression coefficient"
    ) +
  # theme_minimal() +
  theme(
    axis.title.y = element_blank(),
    plot.title = element_text(hjust = .5),
    text = element_text(size = 14),
    axis.text.y = element_text(hjust = 1),
    axis.text.x = element_text(size = 10),
    legend.position = "none"
    ) + 
  facet_grid(category ~ `Need for privacy`, scales = "free_y")

suppressWarnings(print(fig_reg, warning = F))

ggsave("figures/fig_reg.png", width = 10, height = 5)
```

# Save Workspace

```{r cache=T}
save.image("data/workspace_3.RData")
```
